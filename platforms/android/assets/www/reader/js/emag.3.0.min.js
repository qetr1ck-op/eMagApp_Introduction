var fd = new function () {
        function a(a) {
            var e = -1;
            try {
                e = a.GetVariable("$version")
            } catch (b) {}
            return e
        }
        var e = this;
        e.i = !1;
        e.r = "";
        e.m = -1;
        e.mi = -1;
        e.rv = -1;
        e.rS = "";
        var b = [{
            name: "ShockwaveFlash.ShockwaveFlash.7",
            version: function (e) {
                return a(e)
            }
        }, {
            name: "ShockwaveFlash.ShockwaveFlash.6",
            version: function (e) {
                var d = "6,0,21";
                try {
                    e.AllowScriptAccess = "always", d = a(e)
                } catch (b) {}
                return d
            }
        }, {
            name: "ShockwaveFlash.ShockwaveFlash",
            version: function (e) {
                return a(e)
            }
        }];
        e.mAL = function (a) {
            return e.m >= a
        };
        e.miAL = function (a) {
            return e.mi >= a
        };
        e.rAL = function (a) {
            return e.rv >= a
        };
        e.vAL = function (a) {
            for (var d = [e.m, e.mi, e.rv], b = Math.min(d.length, arguments.length), h = 0; h < b; h++)
                if (d[h] >= arguments[h]) {
                    if (!(h + 1 < b && d[h] == arguments[h])) return !0
                } else return !1
        };
        (function () {
            var a, d, i, h, j;
            if (navigator.plugins && navigator.plugins.length > 0) {
                var g = navigator.mimeTypes;
                if (g && g["application/x-shockwave-flash"] && g["application/x-shockwave-flash"].enabledPlugin && g["application/x-shockwave-flash"].enabledPlugin.description) {
                    a = g = g["application/x-shockwave-flash"].enabledPlugin.description;
                    var g = a.split(/ +/),
                        c = g[2].split(/\./),
                        g = g[3];
                    d = parseInt(c[0], 10);
                    i = parseInt(c[1], 10);
                    h = g;
                    j = parseInt(g.replace(/[a-zA-Z]/g, ""), 10) || e.rv;
                    e.r = a;
                    e.m = d;
                    e.mi = i;
                    e.rS = h;
                    e.rv = j;
                    e.i = !0
                }
            } else if (navigator.appVersion.indexOf("Mac") == -1 && window.execScript) {
                g = -1;
                for (c = 0; c < b.length && g == -1; c++) {
                    a = -1;
                    try {
                        a = new ActiveXObject(b[c].name)
                    } catch (l) {
                        a = {
                            activeXError: !0
                        }
                    }
                    if (!a.activeXError && (e.i = !0, g = b[c].version(a), g != -1)) a = g, h = a.split(","), d = parseInt(h[0].split(" ")[1], 10), i = parseInt(h[1], 10), j = parseInt(h[2], 10), h = h[2], e.r = a, e.m = d, e.mi = i, e.rv = j, e.rS = h
                }
            }
        })()
    }, sp = String.prototype;
sp.rT = function (a) {
    var e = this,
        b;
    for (b in a) e = e.replace(RegExp("({~" + b + "~})", "gm"), a[b]);
    return e
};
sp.cp = function () {
    return this[0].toUpperCase() + this.substr(1, this.length).toLowerCase()
};
sp.encodeFileName = function () {
    var a = this.split("/").slice(-1)[0].split("?")[0];
    return this.replace(a, (a.match(/[/?:@&=+$# ]/) ? encodeURIComponent(a) : a).replace(/'/g, "%27"))
};
sp.hex2num = function () {
    for (var a = [], e = this.slice(-6).toUpperCase(), b = 0; b < 6; b += 2) a.push("0123456789ABCDEF".indexOf(e.charAt(b)) * 16 + "0123456789ABCDEF".indexOf(e.charAt(b + 1)));
    return a
};
sp.toHTMLUnicode = function () {
    for (var a = "", e = 0, b = 0; b < this.length; b++) e = this.charCodeAt(b), a += e > 256 ? "&#" + e + ";" : this.charAt(b);
    return a
};
sp.tMN = function () {
    for (var a = this.split("_"), e = 0; e < a.length; e++) a[e] = a[e][e ? "cp" : "toLowerCase"]();
    return a.join("")
};
var EM = EM || {};
EM.U = function () {
    return {
        merge: function (a, e) {
            for (var b in a) e[b] = a[b];
            return e
        },
        p: function (a) {
            var e = EM.U.fSP(a),
                a = EM.U.fP(a);
            return {
                screenX: e[0],
                screenY: e[1],
                clientX: a[0],
                clientY: a[1]
            }
        },
        fSP: function (a) {
            var e = window.screenY,
                b = window.screenX,
                a = EM.U.fP(a);
            return [b + a[0], e + a[1]]
        },
        fP: function (a) {
            var e = 0,
                b = 0;
            if (a && a.offsetParent) {
                do e += a.offsetLeft, b += a.offsetTop; while (a = a.offsetParent)
            }
            return [e, b]
        },
        p: function (a, e, b) {
            window.mm.p(a, e, b)
        },
        include: function (a) {
            window.eval(_$get(appConfig.basePath + a))
        },
        jpk: function (a) {
            if (a)
                for (var e = 0; e < a.length; e++) _$include("js/jpk/" + a[e] + ".jpk")
        },
        sbt: function (a, e) {
            try {
                var b = 0;
                return a.replace(/(\%[A-Z]{2})/g, function () {
                    return "{" + b+++"}"
                }).replace(/\{(.+?)\}/g, function (a, b) {
                    return b in e ? e[b] : a
                })
            } catch (f) {
                $log.error(e)
            }
        },
        gW1: function (a) {
            for (var e = [], b, f = 0; f < a.length; f++) b = a.charCodeAt(f) - 848, b >= 192 && b < 256 ? e.push("%" + b.toString(16)) : e.push(encodeURIComponent(a.charAt(f)));
            return e.join("")
        },
        $: function (a, e, b, f) {
            this.cache = this.cache || {};
            var e = e || document,
                d = a.replace(/ /g, "_");
            if (!b && this.cache[d] && this.cache[d].parent === e) return this.cache[d].result;
            else {
                b = null;
                try {
                    b = e["querySelector" + (f ? "All" : "")](a), this.cache[d] = {
                        parent: e,
                        result: b
                    }
                } catch (i) {}
                b == null && $log.warn("_$()=>" + a);
                return b
            }
        }
    }
}();
EM.U.S = function () {
    return {
        parse: function () {
            function a(a, e, c) {
                return e ? d[e] : String.fromCharCode(parseInt(c, 16))
            }
            var e, b = RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))', "g"),
                f = RegExp("\\\\(?:([^u])|u(.{4}))", "g"),
                d = {
                    '"': '"',
                    "/": "/",
                    "\\": "\\",
                    b: "\u0008",
                    f: "\u000c",
                    n: "\n",
                    r: "\r",
                    t: "\t"
                }, i = new String(""),
                h = Object.hasOwnProperty;
            return function (e, d) {
                var e = e.match(b),
                    c, l = e[0],
                    m = !1;
                "{" === l ? c = {} : "[" === l ? c = [] : (c = [], m = !0);
                for (var k, n = [c], q = 1 - m, p = e.length; q < p; ++q) {
                    var l = e[q],
                        o;
                    switch (l.charCodeAt(0)) {
                        default: o = n[0];
                        o[k || o.length] = +l;
                        k = void 0;
                        break;
                    case 34:
                        l = l.substring(1, l.length - 1);
                        l.indexOf("\\") !== -1 && (l = l.replace(f, a));
                        o = n[0];
                        if (!k)
                            if (o instanceof Array) k = o.length;
                            else {
                                k = l || i;
                                break
                            }
                        o[k] = l;
                        k = void 0;
                        break;
                    case 91:
                        o = n[0];
                        n.unshift(o[k || o.length] = []);
                        k = void 0;
                        break;
                    case 93:
                        n.shift();
                        break;
                    case 102:
                        o = n[0];
                        o[k || o.length] = !1;
                        k = void 0;
                        break;
                    case 110:
                        o = n[0];
                        o[k || o.length] = null;
                        k = void 0;
                        break;
                    case 116:
                        o = n[0];
                        o[k || o.length] = !0;
                        k = void 0;
                        break;
                    case 123:
                        o = n[0];
                        n.unshift(o[k || o.length] = {});
                        k = void 0;
                        break;
                    case 125:
                        n.shift()
                    }
                }
                if (m) {
                    if (n.length !== 1) throw Error();
                    c = c[0]
                } else if (n.length) throw Error();
                if (d) {
                    var r = function (a, e) {
                        var c = a[e];
                        if (c && typeof c === "object") {
                            var k = null,
                                b;
                            for (b in c)
                                if (h.call(c, b) && c !== a) {
                                    var f = r(c, b);
                                    f !== void 0 ? c[b] = f : (k || (k = []), k.push(b))
                                }
                            if (k)
                                for (b = k.length; --b >= 0;) delete c[k[b]]
                        }
                        return d.call(a, e, c)
                    };
                    c = r({
                        "": c
                    }, "")
                }
                return c
            }
        }(),
        get: function (a, e, b, f, d, i) {
            var h = new XMLHttpRequest;
            h.onreadystatechange = function () {
                h.readyState == 4 && (h.status >= 200 && h.status < 300 || h.status === 304 || h.status === 0 ? e && e(h["response" + (d ? "XML" : "Text")]) : b && b(h.status))
            };
            h.open(i || (d ? "post" : "get"), a, e);
            d && h.setRequestHeader("Content-Type", "text/xml");
            h.send(function () {
                if (d) return f;
                else {
                    var a = "?",
                        e;
                    for (e in f) a += encodeURIComponent(e) + "=" + encodeURIComponent(f[e]);
                    return f ? a : f
                }
            }());
            return e ? !0 : h.responseText
        }
    }
}();
var _$ = EM.U.$,
    _$sbt = EM.U.sbt,
    _$gW1 = EM.U.gW1,
    _$p = EM.U.p,
    _$fP = EM.U.fP,
    _$p = EM.U.p,
    _$merge = EM.U.merge,
    _$include = EM.U.include,
    _$jpk = EM.U.jpk,
    _$get = EM.U.S.get;
EM.U.CRYPT = function () {
    return {
        b64encode: function (a) {
            var e, b, f, d, i = 0,
                h = 0,
                j = "",
                j = [];
            if (!a) return a;
            a += "";
            if (a === null || typeof a === "undefined") a = "";
            else {
                a += "";
                e = "";
                b = f = d = 0;
                d = a.length;
                for (var g = 0; g < d; g++) {
                    var c = a.charCodeAt(g),
                        l = null;
                    c < 128 ? f++ : l = c > 127 && c < 2048 ? String.fromCharCode(c >> 6 | 192) + String.fromCharCode(c & 63 | 128) : String.fromCharCode(c >> 12 | 224) + String.fromCharCode(c >> 6 & 63 | 128) + String.fromCharCode(c & 63 | 128);
                    l !== null && (f > b && (e += a.slice(b, f)), e += l, b = f = g + 1)
                }
                f > b && (e += a.slice(b, d));
                a = e
            }
            do e = a.charCodeAt(i++), b = a.charCodeAt(i++), f = a.charCodeAt(i++), d = e << 16 | b << 8 | f, e = d >> 18 & 63, b = d >> 12 & 63, f = d >> 6 & 63, d &= 63, j[h++] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d); while (i < a.length);
            j = j.join("");
            i = a.length % 3;
            return (i ? j.slice(0, i - 3) : j) + "===".slice(i || 3)
        },
        b64decode: function (a) {
            var e, b, f, d, i, h = 0,
                j = 0;
            d = "";
            var g = [];
            if (!a) return a;
            a += "";
            do e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)), b = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)), d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)), i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(h++)), f = e << 18 | b << 12 | d << 6 | i, e = f >> 16 & 255, b = f >> 8 & 255, f &= 255, d == 64 ? g[j++] = String.fromCharCode(e) : i == 64 ? g[j++] = String.fromCharCode(e, b) : g[j++] = String.fromCharCode(e, b, f); while (h < a.length);
            a = d = g.join("");
            h = [];
            e = g = i = d = j = 0;
            for (a += ""; j < a.length;) i = a.charCodeAt(j), i < 128 ? (h[d++] = String.fromCharCode(i), j++) : i > 191 && i < 224 ? (g = a.charCodeAt(j + 1), h[d++] = String.fromCharCode((i & 31) << 6 | g & 63), j += 2) : (g = a.charCodeAt(j + 1), e = a.charCodeAt(j + 2), h[d++] = String.fromCharCode((i & 15) << 12 | (g & 63) << 6 | e & 63), j += 3);
            return d = h.join("")
        }
    }
}();
var $crypt = EM.U.CRYPT,
    $dom = function () {
        function a(a, b) {
            return a.className.match(RegExp("(\\s|^)" + b + "(\\s|$)"))
        }
        return {
            i: function (a, b, f) {
                if (!b.dom) b.dom = a;
                for (var d in f) b.dom[d] = _$(f[d], a, !0);
                return b.dom
            },
            p: function (a, b, f, d) {
                var i = a.style.webkitBackgroundSize;
                a.src = _$sbt(TITT, [appConfig.basePath]);
                a.style.webkitBackgroundSize = "100%";
                a.style.backgroundImage = "url(" + (f || _$sbt(TITT, [appConfig.basePath])) + ")";
                if (!f && !a.dvLoad && a.parentNode) {
                    a.dvLoad = document.createElement("DIV", !0);
                    a.dvLoad.className = "loading";
                    var h = function (d) {
                        if (!d.dvLoad) return !1;
                        if (!d.parentNode) return d.dvLoad.parentNode && d.dvLoad.parentNode.removeChild(a.dvLoad), delete d.dvLoad, d.dvLoad = void 0, !1;
                        if (d.style.webkitBackgroundSize != "100%") i = d.style.webkitBackgroundSize;
                        if (d.index) {
                            var g = i.split(" "),
                                c = parseInt(g[0]),
                                g = parseInt(g[1]),
                                b = window.innerWidth / c < 2 ? (parseInt(d.style.width) - c) / 2 : d.index % 2 ? 0 : parseInt(d.style.width) - c;
                            $dom.move(d.dvLoad, b + c / 2 - d.dvLoad.clientWidth / 2, g / 2 - d.dvLoad.clientHeight / 2)
                        } else d.dvLoad.style.visibility = top.getComputedStyle(d, null).visibility, d.origWidth = parseInt(d.style.width || d.parentNode && d.parentNode.offsetWidth), d.origHeight = parseInt(d.style.height || d.parentNode && d.parentNode.offsetHeight), $dom.move(d.dvLoad, d.offsetLeft + parseInt(d.origWidth) / 2 - d.dvLoad.clientWidth / 2, d.offsetTop + parseInt(d.origHeight) / 2 - d.dvLoad.clientHeight / 2);
                        return !0
                    };
                    a.index ? a.appendChild(a.dvLoad) : a.parentNode.appendChild(a.dvLoad);
                    h(a);
                    a.tidLoad && clearInterval(a.tidLoad);
                    a.tidLoad = setInterval(function () {
                        h(a) || clearInterval(a.tidLoad)
                    }, 300)
                }
                _$p(b, function (b, g) {
                    a.src = g;
                    a.style.backgroundImage = _$sbt("url({0})", [g]);
                    a.style.webkitBackgroundSize = i;
                    if (a.dvLoad) a.dvLoad.parentNode.removeChild(a.dvLoad), delete a.dvLoad, a.dvLoad = void 0;
                    if (d) {
                        if (b.width) a.origWidth = parseInt(b.width), a.origHeight = parseInt(b.height);
                        d(a)
                    }
                }, b)
            },
            dispatchClick: function (a) {
                if ($ua.isTouch()) {
                    for (var b = a.changedTouches[0], f = b.target, d = document.createEvent("MouseEvents"); f.nodeType != 1;) f = f.parentNode;
                    d.initMouseEvent("click", !0, !0, a.view, 1, b.screenX, b.screenY, b.clientX, b.clientY, a.ctrlKey, a.altKey, a.shiftKey, a.metaKey, 0, null);
                    f.dispatchEvent(d)
                }
            },
            list: function (a, b, f, d) {
                a.innerHTML = "";
                for (var f = document.createElement(f, !0), i, h = 0; h < b; h++) i = f.cloneNode(!0), a.appendChild(i), d(i, h)
            },
            rA: function (a) {
                for (; a.hasChildNodes();) a.removeChild(a.firstChild)
            },
            size: function (a, b, f) {
                a.style.width = b ? b + "px" : "";
                a.style.height = f ? f + "px" : ""
            },
            gz: function (a) {
                var b = Number(a.style.width.replace("px", "")) || 0,
                    a = Number(a.style.height.replace("px", "")) || 0;
                return {
                    width: b,
                    height: a
                }
            },
            move: function (a, b, f) {
                a.style.left = b ? b + "px" : "";
                a.style.top = f ? f + "px" : ""
            },
            margin: function (a, b, f) {
                a.style.marginLeft = b + "px";
                a.style.marginTop = f + "px"
            },
            hC: a,
            aC: function (e, b) {
                if (!a(e, b)) e.className = e.className.replace(/\s*$/, " ") + b
            },
            rC: function (e, b) {
                for (var f = b.split(/\s/), d = e.className, i = 0; i < f.length; i++) a(e, f[i]) && (d = d.replace(RegExp("(\\s|^)" + f[i] + "(\\s|$)"), " "));
                e.className = d
            },
            rc: function (a, b, f) {
                a.className = a.className.replace(b, f)
            },
            uC: function (a, b, f) {
                f ? this.aC(a, b) : this.rC(a, b)
            },
            tC: function (e, b) {
                a(e, b) ? this.rC(e, b) : this.aC(e, b)
            },
            showed: function (a) {
                return a.style.display == "block"
            },
            show: function (a, b) {
                a.style.display = b || "block";
                a.style.visibility = "visible"
            },
            hide: function (a) {
                typeof a == "string" && (a = _$(a));
                a.style.display = "none";
                a.style.visibility = "hidden"
            },
            transparent: function (a, b) {
                a.style.opacity = b || "0"
            },
            sN: function (a, b) {
                var f = a.cloneNode(!0),
                    d = b.cloneNode(!0);
                a.parentNode.insertBefore(f, a);
                b.parentNode.insertBefore(d, b);
                a.parentNode.insertBefore(b, f);
                b.parentNode.insertBefore(a, d);
                a.parentNode.removeChild(f);
                b.parentNode.removeChild(d)
            },
            cTA: function (a) {
                for (var b = [], f = 0; f < a.length; f++) b[f] = a[f];
                return b
            },
            transitionEndHandle: function (a, b) {
                a.complete = b;
                a.addEventListener("webkitTransitionEnd", function () {
                    this.removeEventListener("webkitTransitionEnd", arguments.callee);
                    this.complete(this)
                })
            },
            animationEndHandle: function (a, b) {
                a.complete = b;
                a.animationCompleted = !1;
                a.addEventListener("webkitAnimationEnd", function (a) {
                    if (!this.animationCompleted) this.animationCompleted = !0, this.removeEventListener("webkitAnimationEnd", arguments.callee), this.complete(this)
                });
                setTimeout(function (a) {
                    if (!a.animationCompleted) a.animationCompleted = !0, a.removeEventListener("webkitAnimationEnd", arguments.callee), a.complete(a)
                }, 300, a)
            }
        }
    }(),
    $wkit = function () {
        function a(a) {
            return f + (a ? " scale({2})" : "")
        }

        function e(d, e, b, f, g) {
            var c = new WebKitCSSMatrix(d.style.webkitTransform);
            if (e == null) e = c.e;
            if (b == null) b = c.f;
            if (f == null) f = c.a;
            d.style.webkitTransform = _$sbt(g ? "translate({0}px,{1}px)" + (f ? " scale({2})" : "") : a(f), [e, b, f])
        }
        var b = "WebKitCSSMatrix" in window && "m11" in new WebKitCSSMatrix,
            f = "translate" + (b ? "3d(" : "(") + "{0}px,{1}px" + (b ? ",0px)" : ")");
        return {
            has3d: b,
            gTT: a,
            gT: function (a) {
                a = new WebKitCSSMatrix(a.style.webkitTransform);
                return {
                    x: a.e,
                    y: a.f,
                    zoom: a.a
                }
            },
            translate: function (a, b, f) {
                e(a, b, f, null)
            },
            scale: function (a, b, f) {
                e(a, null, null, b, f)
            }
        }
    }();
EM.U.UADETECT = function () {
    function a(a) {
        for (var b = navigator.userAgent.toLowerCase(), f = 0; f < a.length; f++)
            if (b.search(a[f]) != -1) return !0;
        return !1
    }
    return {
        getOSVersion: function () {
            if (a(["\\(iphone;", "\\(ipod;", "\\(ipad;"])) {
                var e = navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);
                return [parseInt(e[1], 10), parseInt(e[2], 10), parseInt(e[3] || 0, 10)]
            } else if (a(["android"])) return e = navigator.userAgent, e.slice(e.indexOf("Android") + 8).split(".")
        },
        isTouch: function () {
            return "ontouchstart" in window
        },
        iP: function () {
            return a(["\\(iphone;", "\\(ipod;", "\\(ipad;"])
        },
        iPad: function () {
            return a(["\\(ipad;"])
        },
        droid: function () {
            if (a(["webkit"])) return a(["android"])
        },
        mobWkit: function () {
            return a(["webkit"]) ? a(["android", "\\(iphone;", "\\(ipod;", "\\(ipad;"]) : !1
        },
        wm: function () {
            return a(["windows ce"])
        },
        macOS: function () {
            return a(["macintosh"])
        },
        allowed: function () {
            return a("safari,maxthon,dolfin,skyfire,mercury,fbios".split(","))
        },
        chrome: function () {
            return a(["chrome"])
        }
    }
}();
var $ua = EM.U.UADETECT,
    $xml = new function () {
        function a(a) {
            return a.replace(/>[\n,\r, ]+/igm, ">").replace(/[\n,\r, ]+</igm, "<")
        }

        function e(a) {
            var b = {}, f, j;
            if (a.nodeType == 1) {
                if (a.attributes && a.attributes.length > 0) {
                    b["#attributes"] = {};
                    for (j = 0; j < a.attributes.length; j++) f = a.attributes.item(j), b["#attributes"][f.nodeName] = f.nodeValue
                }
            } else if (a.nodeType == 3) b = a.nodeValue;
            if (a.hasChildNodes())
                for (j = 0; j < a.childNodes.length; j++) {
                    f = a.childNodes.item(j);
                    var g = f.nodeName;
                    if (typeof b[g] == "undefined") b[g] = e(f);
                    else {
                        if (typeof b[g].length == "undefined") {
                            var c = b[g];
                            b[g] = [];
                            b[g].push(c)
                        }
                        b[g].push(e(f))
                    }
                }
            return b
        }

        function b(a, e) {
            var f = {}, j = [],
                f = "";
            if (f = a["#attributes"])
                for (var g in f) j.push(g + '="' + f[g] + '"');
            if (!(f = a["#text"])) {
                g = [];
                for (var c in a) c.charAt(0) != "#" && g.push(b(a[c], c));
                f = g.join("\r\n")
            }
            return e ? "<" + e + " " + j.join(" ") + ">" + f + "</" + e + ">" : f
        }
        var f = this;
        f.trim = a;
        f.toJSONObject = function (a) {
            return a ? e(a) : a
        };
        f.fromJSONObject = function (a) {
            return f.fromString(b(a))
        };
        f.toString = function (a) {
            return a ? (new XMLSerializer).serializeToString(a.nodeType == void 0 ? f.fromJSONObject(a) : a) : ""
        };
        f.fromString = function (d) {
            return d.charAt(0) == "<" ? (new DOMParser).parseFromString(a(d), "text/xml") : b((window.JSON || EM.U.S).parse(d))
        };
        return f
    }, $soap = function () {
        return {
            createRequest: function (a, e, b) {
                var f = {}, e = f[a + "." + e] = {
                        "#attributes": {
                            "soapenv:encodingStyle": "http://schemas.xmlsoap.org/soap/encoding/"
                        },
                        "return": {
                            "#attributes": {
                                "xsi:type": e + "Request"
                            }
                        }
                    };
                if (b)
                    for (var d in b) e["return"][d] = b[d];
                a = {
                    "soapenv:Envelope": {
                        "#attributes": {
                            "xmlns:xsi": "http://www.w3.org/2001/XMLSchema-instance",
                            "xmlns:xsd": "http://www.w3.org/2001/XMLSchema",
                            "xmlns:soapenv": "http://schemas.xmlsoap.org/soap/envelope/",
                            "xmlns:urn": a
                        },
                        "soapenv:Header": {},
                        "soapenv:Body": {}
                    }
                };
                f && (a["soapenv:Envelope"]["soapenv:Body"] = f);
                return a
            },
            createField: function (a, e) {
                return {
                    "#attributes": {
                        "xsi:type": "xsd:" + a
                    },
                    "#text": e
                }
            },
            sendRequest: function (c, d, b, e) {
                $log.info("Read data from server: " + $xml.toString(d));
                return _$get(c, b, e, '<?xml version="1.0" encoding="utf-8"?>' + $xml.toString(d), true, "post", true)
            },
            getNode: function (d, c, b) {
                return c["SOAP-ENV:Envelope"]["SOAP-ENV:Body"]["ns1:Webservices" + d + "." + b + "Response"]["return"]
            },
            getResponseNode: function (d, c, b) {
                return $soap.getNode(d, c, b)["response"]
            },
            getErrorNode: function (d, c, b) {
                return $soap.getNode(d, c, b)["error"]
            },
            getFieldValue: function (c, b) {
                return b ? c[b]["#text"] : c["#text"]
            }
        }
    }();

function cMemoryManager() {
    var a = this,
        e = {}, b = {}, f = ["div", "span", "img", "li"],
        d = [],
        i = 0,
        h = [],
        j = function (a) {
            return a === document.body ? !0 : a.parentNode ? j(a.parentNode) : !1
        }, g = function (a, c, d) {
            this.events = this.events || [];
            this.events.push({
                type: a,
                func: c
            });
            this._addEventListener_i(a, c, d)
        }, c = function (a) {
            var c = this.tagName.toLowerCase(),
                a = e[c] && e[c].length ? e[c].pop() : this._cloneNode_i(a);
            return l(a)
        }, l = function (a) {
            var d = a.tagName.toLowerCase();
            if (e[d] && !a.used) {
                if (!a._addEventListener_i) a._addEventListener_i = a.addEventListener, a.addEventListener = g, a._cloneNode_i = a.cloneNode, a.cloneNode = c;
                a.used = !0;
                b[d].push(a)
            }
            return a
        }, m = function (a, c, d) {
            var b;
            (b = window.cache[a]) ? c(b, d) : (b = document.createElement("img"), b.addEventListener("load", function () {
                this.removeEventListener("load", arguments.callee);
                window.cache[a] = this;
                c(this, d)
            }), b.src = a)
        }, k = function () {
            if (h.length && i < 10) {
                var a = h.pop();
                m(a[0], function (c, d) {
                    i--;
                    setTimeout(k, 100);
                    a[1](c, d)
                }, a[2]);
                i++
            }
        };
    a.p = function (a, c, d) {
        h.push([a, c, d]);
        k()
    };
    a.DOMSubtreeModified = function (a) {
        if (a.target.nodeType == 1) {
            var a = b,
                c = {}, d;
            for (d in a) {
                c[d] = [];
                for (var g = 0; g < a[d].length; g++) {
                    var k = a[d][g];
                    if (j(k)) c[d].push(k);
                    else {
                        for (var f = k.tagName.toLowerCase(), n = k, h = n.events || [], i = 0; i < h.length; i++) n.removeEventListener(h[i].type, h[i].func, !1);
                        k.id = "";
                        k.name = "";
                        k.className = "";
                        k.used = !1;
                        k.removeAttribute("style");
                        f == "img" ? k.src = "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" : "div,li,span".indexOf(f) >= 0 ? k.innerHTML = "" : $log.error('Release is not supported for "' + f + '" nodes.');
                        e[f].push(k)
                    }
                }
            }
            b = c
        }
    };
    a.handleEvent = function (c) {
        a[c.type](c)
    };
    a.__defineGetter__("stats", function () {
        var a = "",
            c;
        for (c in e) a += c + ": " + e[c].length + "\n";
        var g = "";
        for (c in b) g += c + ": " + b[c].length + " (D:" + document.getElementsByTagName(c).length + ")\n";
        return "POOL STATS:\n" + a + "\nALLOCATED STATS:\n" + g + "\nPRELOADED IMAGES: " + d.length
    });
    document.createElement_i = document.createElement;
    document.createElement = function (a, c) {
        var d = a.toLowerCase(),
            d = e[d] && e[d].length ? e[d].pop() : document.createElement_i(d);
        return c ? l(d) : d
    };
    for (var n = 0; n < f.length; n++) e[f[n]] = [], b[f[n]] = [];
    (function (c) {
        for (var d = 0; d < c.length; d++) window.addEventListener(c[d], a, !1)
    })(["DOMSubtreeModified"])
}
window.mm = new cMemoryManager;
var $log = function () {
    function a(a, d) {
        var i = "." + (new Date - e) + " [" + d + "]: " + (a ? a + (a.type || "") : a);
        if (!R)
            if (window.console && window.console[b[d]]) window.console[b[d]](i);
            else window.console && window.console.log ? window.console.log(i) : alert(i)
    }
    var e = new Date,
        b = {
            INFO: "info",
            WARN: "warn",
            ERROR: "error"
        };
    return {
        info: function (b) {
            a(b, "INFO")
        },
        warn: function (b) {
            a(b, "WARN")
        },
        error: function (b) {
            a(b, "ERROR")
        },
        fatal: function (b) {
            b && a(b.message, "ERROR")
        }
    }
}();

function csc(a, e, b, f) {
    var d = this,
        i = [],
        h, j = {
            pos: 0,
            gM: function () {
                return {
                    pos: 0,
                    dur: 0
                }
            }
        }, g = {
            dir: {
                x: j,
                y: j
            }
        }, c, l, m = function (a, c) {
            var d = [],
                b;
            for (b in g.dir) d.push(g.dir[b][a] ? g.dir[b][a](c) : 0);
            return d
        }, k = function (c) {
            if (!d.d) a.style.webkitTransform = _$sbt($wkit.gTT(), g.pos = c)
        }, n = function (c) {
            c = c || "0";
            a.style.webkitTransitionDuration = c;
            m("stt", c)
        }, q = function () {
            var a = m("resetPositionGet");
            a[0] != g.dir.x.pos || a[1] != g.dir.y.pos ? p(a) : (h = !1, m("hide"), d.onScrollEnd(g))
        }, p = function (c, b) {
            l || (c.join() == g.pos.join() ? q() : (h = !0, a.addEventListener("webkitTransitionEnd", d), n(b || "350ms"), k(c)))
        };
    g.i = function () {
        var c = {
            x: {
                style: "Width",
                show: e
            },
            y: {
                style: "Height",
                show: b
            }
        }, d, k = a.parentNode,
            n;
        for (n in c)
            if (c[n].show) d = c[n].style, a.style[d.toLowerCase()] = (k["_scroll" + d] || k["scroll" + d]) + "px", g.dir[n].i || (g.dir[n] = new csb(n, k, f)), g.dir[n].i(k["client" + d], a["offset" + d])
    };
    g.__defineGetter__("pos", function () {
        return [this.dir.x.pos, this.dir.y.pos]
    });
    g.__defineSetter__("pos", function (a) {
        this.dir.x.pos = a[0];
        this.dir.y.pos = a[1]
    });
    a.instance = d;
    d.owner = a;
    d.d = !1;
    d.lockedClick = !0;
    d.scrollBars = g;
    d.onScrollEnd = function () {};
    d.setPosition = function (a, c) {
        p([-a[0], -a[1]], c)
    };
    d.shift = function (a, c) {
        p([a[0] + g.dir.x.pos, a[1] + g.dir.y.pos], c)
    };
    d.resetPosition = function () {
        p([0, 0])
    };
    d.handleEvent = function (a) {
        if (d.d) return !0;
        var c = i[a.type];
        if (c != "webkitTransitionEnd" && (c != "touchStart" || d.lockedClick)) a.preventDefault(), a.stopPropagation();
        (d[c] || $log.fatal)(a, {
            setPos: k,
            invoke: m,
            stt: n
        })
    };
    d.touchStart = function (b) {
        l = !0;
        h = !1;
        n(0);
        if ($wkit.has3d) {
            var e = new WebKitCSSMatrix(window.getComputedStyle(a).webkitTransform);
            if (e.e != g.dir.x.pos || e.f != g.dir.y.pos) document.removeEventListener("webkitTransitionEnd", d, !1), k([e.e, e.f]), h = !0
        }
        c = b.timeStamp;
        m("setScrollStart");
        m("setTouchStart", b)
    };
    d.touchMove = function (a) {
        l && !(a.webkitMovementX == 0 && a.webkitMovementY == 0) && (k(m("getMovePos", a)), m("setTouchStart", a), h = !0)
    };
    d.touchEnd = function (a) {
        l && (l = !1, h ? (a = a.timeStamp - c, a > 250 ? q() : (a = m("gM", Math.min(a, 250)), p([a[0].pos, a[1].pos], Math.max(a[0].dur, a[1].dur) + "ms"))) : (q(), d.lockedClick && $dom.dispatchClick(a)))
    };
    d.transitionEnd = function () {
        a.removeEventListener("webkitTransitionEnd", d, !1);
        q()
    };
    d.refresh = function (a, c) {
        g.i();
        a ? q() : (n(0), k(c || [0, 0]))
    };
    (function (c) {
        for (var b = 0; b < c.length / 3; b++) i[c[b * 3]] = c[b * 3 + 1], c[b * 3 + 2] && a.addEventListener(c[b * 3], d)
    })([$ua.isTouch() ? "touchstart" : "mousedown", "touchStart", !0, $ua.isTouch() ? "touchmove" : "mousemove", "touchMove", !0, $ua.isTouch() ? "touchend" : "mouseup", "touchEnd", !0, "webkitTransitionEnd", "transitionEnd", !1]);
    return d
}

function csb(a, e, b) {
    var f = this,
        d = 0,
        i = 0,
        h = 0,
        j = 0,
        g = 0,
        c = 0;
    f.gPP = function (c) {
        return ($ua.isTouch() ? c.changedTouches[0] : c)["page" + (new String(a)).toUpperCase()]
    };
    f.i = function (c, d) {
        function g(c, d, b, k, f, n, h, i) {
            c = document.getCSSCanvasContext("2d", "scrollbar" + e.id + a, c, d);
            c.fillStyle = "rgb(0,0,0)";
            c.beginPath();
            c.arc(2.5, 2.5, 2.5, f, n, !1);
            c.lineTo(h, i);
            c.arc(b, k, 2.5, n, f, !1);
            c.closePath();
            c.fill()
        }
        var p = Math.PI;
        h = c;
        j = d;
        i = c - d;
        if (!b)
            if (a == "x") {
                if (f.maxSize != m.offsetWidth) f.maxSize = m.offsetWidth, g(f.maxSize, 5, f.maxSize - 2.5, 2.5, p / 2, -p / 2, f.maxSize - 2.5, 0)
            } else if (f.maxSize != m.offsetHeight) f.maxSize = m.offsetHeight, g(5, f.maxSize, 2.5, f.maxSize - 2.5, p, 0, 5, f.maxSize - 2.5);
        f.size = Math.max(Math.round(f.maxSize * f.maxSize / d), 6);
        f.maxScroll = f.maxSize - f.size;
        f.tWP = Math.min(f.maxScroll / i, 0);
        b || (l.style[a == "x" ? "width" : "height"] = f.size + "px")
    };
    f.__defineGetter__("pos", function () {
        return d
    });
    f.__defineSetter__("pos", function (c) {
        d = c;
        if (!b) m.style.opacity != "1" && f.show(), c = Math.round(f.tWP * c), c < 0 ? (c = $ua.iP() || !$ua.isTouch() ? c + c * 3 : 0, f.size + d < 7 && (c = -f.size + 6)) : c > f.maxScroll && (c = $ua.iP() || !$ua.isTouch() ? c + (c - f.maxScroll) * 3 : f.maxScroll, f.size + f.maxScroll - c < 7 && (c = f.size + f.maxScroll - 6)), l.style.webkitTransform = _$sbt($wkit.gTT(!1), [c, 0].sort(function (c, d) {
            return a == "x" ? 0 : Math.abs(c) - Math.abs(d)
        }))
    });
    f.getMovePos = function (a) {
        var a = f.gPP(a) - c,
            b = d + a;
        if (b >= 0 || b < i) b = $wkit.has3d ? Math.round(d + a / 3) : b >= 0 || i >= 0 ? 0 : i;
        return b
    };
    f.getLey = function (a) {
        var c = g - d;
        c && a <= Math.abs(c) ? c /= Math.abs(c) : c = 0;
        return c
    };
    f.setTouchStart = function (a) {
        c = f.gPP(a)
    };
    f.getScrollStart = function () {
        return g
    };
    f.setScrollStart = function () {
        g = d
    };
    f.gM = function (a) {
        var c = {
            pos: d,
            dur: 0
        };
        if ($wkit.has3d) {
            var a = Math.abs(d - g) / a * 1E3,
                b = a * a / 2.5 / 1E3;
            d - g > 0 && b > h / 5 - d ? (a = a * (h / 5 - d) / b / 2.5, b = h / 5 - d) : d - g < 0 && b > d + j - h + h / 5 && (a = a * (d + j - h + h / 5) / b / 2.5, b = d + j - h + h / 5);
            c.pos = d + Math.round(b * (d - g < 0 ? -1 : 1));
            c.dur = Math.max(Math.round(a / 1.2), 1)
        }
        return c
    };
    f.stt = function (a) {
        if (!b) l.style.webkitTransitionDuration = a, m.style.webkitTransitionDuration = $wkit.has3d && ($ua.iP() || !$ua.isTouch()) ? "300ms" : "0"
    };
    f.resetPositionGet = function () {
        return d >= 0 || i > 0 ? 0 : d < i ? i : d
    };
    f.show = function () {
        if (!b) {
            if ($wkit.has3d) m.style.webkitTransitionDelay = "0";
            m.style.opacity = "1"
        }
    };
    f.hide = function () {
        if (!b) {
            if ($wkit.has3d) m.style.webkitTransitionDelay = "350ms";
            m.style.opacity = "0"
        }
    };
    f.disable = function (a) {
        $dom[a ? "hide" : "show"](m)
    };
    if (!b) {
        var l = document.createElement("div");
        l.className = "scrollBar";
        l.style.cssText = "position:absolute;top:0;left:0;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);per-events:none;-webkit-transition-duration:0;-webkit-transition-delay:0;-webkit-transition-property:-webkit-transform;z-index:100;-webkit-transform:" + _$sbt($wkit.gTT(!1), [0, 0]) + ";" + (a == "x" ? "-webkit-border-radius:3px 2px;min-width:6px;min-height:5px" : "-webkit-border-radius:2px 3px;min-width:5px;min-height:6px");
        var m = document.createElement("div");
        m.style.cssText = "=-webkit-mask:-webkit-canvas(scrollbar" + e.id + a + ");position:absolute;z-index:100;per-events:none;overflow:visible;opacity:0;-webkit-transition-duration:" + ($ua.iP() || !$ua.isTouch() ? "300ms" : "0") + ";-webkit-transition-delay:0;-webkit-transition-property:opacity;" + (a == "x" ? "bottom:2px;left:2px;right:7px;height:5px" : "top:2px;right:2px;bottom:7px;width:5px;");
        m.appendChild(l);
        e.appendChild(m)
    }
    return f
}

function cspBase() {
    function a(a, e, h, j, g, c) {
        $dom.animationEndHandle(a, function () {
            $dom.rC(e, "in reverse " + h);
            $dom.rC(a, "jCurrent out reverse " + h);
            f != a && $dom.hide(a);
            b.onStateChanged(g);
            c && c()
        });
        $dom.show(e);
        $dom.aC(e, h + " in jCurrent " + (j ? " reverse" : ""));
        $dom.aC(a, h + " out" + (j ? " reverse" : ""))
    }

    function e(a, e, f) {
        b.hist.unshift({
            page: a,
            animation: e,
            id: a.id,
            state: f
        })
    }
    var b = this,
        f;
    b.onStateChanged = function () {};
    b.goToScreen = function (b, f, h, j) {
        var g = _$(".jCurrent", !1, !0),
            b = typeof b == "string" ? _$("#" + b) : b,
            f = f || "slideup";
        g == null || b == null || g === b ? $log.error("#gtp not exist") : (h = h || 0, a(g, b, f, !1, h, j), e(b, f, h))
    };
    b.goBack = function (d) {
        if (!(b.hist.length <= 1)) {
            var i = b.hist[0].page,
                h = b.hist[0].animation;
            d ? (b.hist = [], e(f, "slideup", 0)) : b.hist.splice(0, 1);
            a(i, b.hist[0].page, h, !0, b.hist[0].state)
        }
    };
    b.l = function () {
        b.hist = [];
        f = _$(".jCurrent");
        e(f, "slideup")
    };
    return b
}
var CPW = 49,
    OP = "cPortrait",
    OL = "cLandscape",
    OP_FORCED = "cForcedPortrait",
    CPC = $ua.iP() ? $ua.getOSVersion()[0] >= 6 ? 12 : 8 : 12,
    SHR = 1E5,
    ILFT = 2E3,
    OCI = 1E3,
    UHPG = /#\/(\d+)/,
    UHPS = "#/{0}/",
    TTBH = 55,
    BUTTON_MEDIA_WIDTH = 60,
    BUTTON_WAY_WIDTH = 30,
    BUTTON_MEDIA_HEIGHT = 45,
    ZP = 0.25,
    TUB = "{0}index.html#/{1}",
    TIP = "{0}pages/page{1}.jpg",
    TIZ = "{0}zoompages/zoompage{1}.jpg",
    TIT = "{0}thumbnails/thumbnail{1}.jpg",
    TIL = "{0}img/custom/loading.png",
    TITT = "{0}img/base/transparent.png",
    R = _$("script", null, !1, !0).length == 1,
    SP = top.STARTUP_METHOD || "DOMContentLoaded",
    PT_SCROLL = 0,
    PT_3DWEB_KIT = 1,
    PT_3DCANVAS = 2,
    PT_2DWEB_KIT = 3,
    labels = {
        other: {
            lblInstructionLabel: "Swipe your finger across the pages to browse the publication\n or double tap on a page to zoom in.\n\nTap to close this message.",
            lblGoToPage: "Go to page: (%SP of %EP)",
            lblConnectionToServerLost: "Connection to server lost",
            lblPageText: "<center>==Page %CP==</center> \n %PT \n\n",
            lblTrialLimitation: "This eMag was presented in a trial version with a time limitation of 120 seconds. Open the eMag again to review it.",
            lblNoTextOnThisPage: "[NO TEXT ON THIS PAGE]"
        },
        search: {
            btnSearch: "Search",
            lblEnterCorrectTerm: "Enter correct term",
            btnClear: "Clear",
            lblNPagesFound: "%PC Pages Found",
            lblSearchTerm: "Search term",
            lblResults: "Results",
            lblNoMatchesFound: "No matches found"
        },
        menu: {
            menuShare: "Share",
            menuText: "Text",
            menuImage: "Image",
            menuEmail: "Email",
            menuMenu: "Menu",
            menuNext: "Next",
            menuZoom: "Zoom",
            menuShareThis: "Share This!",
            menuSearch: "Search",
            menuBookmarks: "Bookmarks",
            menuPrev: "Prev",
            menuIndex: "Index",
            menuGoTo: "GoTo"
        },
        general: {
            btnBack: "Back",
            lblPage: "Page",
            btnCancel: "Cancel",
            btnOK: "OK",
            lblLoading: "Loading...",
            lblBrowserError: "The publication is not supported by this browser. Try to use one of the next browsers: original Android/iOS browsers, Maxthon, Dolphin, Skyfire, EasyBrowser, Mercury, Safari, Chrome. Thanks!"
        }
    }, appConfig = {
        basePath: "",
        imgDir: "./../source/images/",
        dataUrl: "./../config/reader_json.xml",
        tmlSocEmail: "mailto: ?subject={1}&body={1}:%20{0}",
        socBookmarks: {
            twitter: {
                url: "https://twitter.com/intent/tweet?text={1} {0}"
            },
            facebook: {
                url: "http://facebook.com/sharer.php?u={0}&t={1}"
            },
            digg: {
                url: "http://digg.com/submit?phase=2&url={0}&title={1}"
            },
            delicious: {
                url: "http://delicious.com/post?url={0}&title={1}"
            },
            stumbleupon: {
                url: "http://www.stumbleupon.com/submit?url={0}&title={1}"
            },
            myspace: {
                url: "http://www.myspace.com/Modules/PostTo/Pages/?u={0}&t={1}"
            },
            youtube: {
                wth: "http://www.youtube.com/watch?v={0}",
                thl: "http://i.ytimg.com/vi/{0}/hqdefault.jpg",
                emd: "http://www.youtube.com/embed/{0}?html5=1&feature=player_embedded&iv_load_policy=3&controls=1&version=3&showinfo=0&rel=0&autoplay=1",
                flv: "http://www.youtube.com/e/{0}?version=3&enablejsapi=1&playerapiid={1}&controls=1&rel=0&showinfo=0&feature=player_embedded"
            },
            linkedin: {
                url: "http://www.linkedin.com/shareArticle?mini=true&url={0}&title={1}"
            },
            google: {
                url: "https://www.google.com/bookmarks/mark?op=add&bkmk={0}&title={1}"
            },
            other: {
                url: "http://www.addthis.com/bookmark.php?url={0}&title={1}"
            }
        }
    };

function cbm(a) {
    function e() {
        var a = g.gup();
        if (isNaN(a) || a > g.pages.length || a < 0) a = 1;
        return a
    }

    function b() {
        var a = appConfig.imgDir + ($ua.iP() ? ($ua.iPad() ? "ipad" : "iphone") + "/images/" : "");
        g.url.page = TIP.replace("{0}", a).replace("{1}", "{0}");
        g.url.zoom = TIZ.replace("{0}", a).replace("{1}", "{0}");
        g.url.thumb = TIT.replace("{0}", a).replace("{1}", "{0}")
    }

    function f(c) {
        if (a.irc && g._imgSizes[2] % 2) {
            var b = i([51244435, 85050348]);
            a[b] === void 0 && (b = b.substr(0, 1));
            a[b] = c(i([13144, 45553]), !1, !0, !0)
        }
    }

    function d(c) {
        var b = c ? Math.min(g.cp + (g.cp == 1 || a.mz.isShowed ? 1 : g.pageStep), g.pages.length) : g.cp - (g.cp == 2 || a.mz.isShowed ? 1 : g.pageStep);
        g.marginalPageNumbers = a.pagerType ? [g.pPages[0].index, g.pPages[g.pPages.length - 1].index] : [g.pPages[1].image.index, g.pPages[g.pPages.length - 2].image.index];
        g.frozenSide != c && g.gtp(b);
        if (c ? b - (a.mo.lp ? 0 : 1) >= g.marginalPageNumbers[1] && b != g.pages.length : b + (a.pagerType ? a.mo.lp ? 0 : 1 : -2) <= g.marginalPageNumbers[0] && b != 1) g.frozenSide = c
    }

    function i(a) {
        for (var b = "", d = b + a[0], a = b + a[1], a = (d.length > a.length ? "0" : "") + a, e = 0; e < d.length; e++) b += (typeof c.ss[d.charAt(e)])[a.charAt(e)]["to" + (d.charAt(e) == 0 ? "Upper" : "Lower") + "Case"]();
        return b
    }

    function h(c) {
        $log.error(a.loc("lblConnectionToServerLost") + " (" + c + ")");
        a.sa("LoadError", !1, !0)
    }

    function j(d) {
        d = (c.JSON || EM.U.S).parse(d);
        g._imgSizes = d.imageWidths.images;
        b();
        g.settings = d.settings || {};
        g.pdfPath = d.pdfFilePath;
        a.labels = d.labels || labels;
        a.labels.other.trial = a.labels.other.lblTrialLimitation;
        g.pageHolders = d.pageContentHolders;
        g.imgRatio = Math.round(g._imgSizes[2] / g._imgSizes[3] * 1E4) / 1E4;
        g.pages = d.pages;
        g.marks = d.bookmarks;
        g.docStage = d.documentStageEvents;
        g.cb = d.title;
        g.cp = e();
        g.jumpToPage = !0;
        _$("title").innerText = g.cb;
        _$get(appConfig.basePath + "tmpl/" + ["default", "device/iOS", "device/droid", "common"][a.pagerType] + "/pager.htm", function (c) {
            g.internalTags = _$merge(g.internalTags, {
                PageReader: c
            });
            a.old();
            l(f, m, a.sa)
        }, h);
        d.readerStyleID && $dom.aC(_$("#content"), d.readerStyleID + "Skin")
    }
    var g = this,
        c = a.c,
        l = c[i([2410134132, 445524611])],
        m = 12E4;
    g.gup = function () {
        if (!c.location.hash) return -1;
        var a = UHPG.exec(c.location.hash);
        return a && a.length == 2 ? parseInt(a[1]) : -1
    };
    g.gbu = function () {
        return encodeURIComponent(_$sbt(TUB, [(window.eMagPromo ? appConfig.imgDir : c.location.href).split("pubData")[0], g.cp]))
    };
    g.gzs = function () {
        return {
            width: g._imgSizes[4],
            height: g._imgSizes[5]
        }
    };
    g.goToFirst = function () {
        g.gtp(1)
    };
    g.goToLast = function () {
        g.gtp(g.pages.length)
    };
    g.n = function () {
        g.il || d(!0)
    };
    g.p = function () {
        g.fi || d(!1)
    };
    g.gtp = function (b) {
        var d = g.pages ? g.pages.length : 0;
        if (isNaN(b) || g.cp == b || d == 0 || b > d || b < 1) return !1;
        g.jumpToPage = Math.abs(b - g.cp) > 2;
        g.cp = b;
        a.dp();
        c.location.hash = _$sbt(UHPS, [g.cp]);
        return !0
    };
    g.fp = function (a) {
        for (var c = [], b, d = RegExp(a, "ig"), e = 0; e < g.pages.length; e++)
            if (a = g.pages[e], a.text && (b = a.text.match(d))) a.id = e, a._occur = b.length, c.push(a);
        return c
    };
    g.l = function () {
        g.url = {};
        g.cb = "";
        g.internalTags = {};
        var b = appConfig.basePath != "" ? appConfig.imgDir : c.location.host + c.location.pathname,
            d = a.useStorage && c.localStorage ? c.localStorage[b] : c.cache[b];
        d ? j(d) : _$get(appConfig.dataUrl, function (d) {
            try {
                a.useStorage && c.localStorage ? c.localStorage[b] = d : c.cache[b] = d
            } catch (e) {
                $log.warn(e.message)
            }
            j(d)
        }, h)
    };
    g.__defineGetter__("pageStep", function () {
        return Number(a.mo.lp) + 1
    });
    g.__defineGetter__("fi", function () {
        return g.cp == 1
    });
    g.__defineGetter__("il", function () {
        return g.cp >= g.pages.length || a.mo.lp && g.pages.length % 2 && g.cp == g.pages.length - 1
    });
    return g
}

function czm(a) {
    function e(c) {
        m = a.mb.cp;
        a.mo.lp && (m = Math.min(a.mb.pages.length, Math.max(1, m - m % 2 + (c < a.grs("Width") / 2 ? 0 : 1))))
    }
    var b = this,
        f, d, i, h, j, g, c = !1,
        l = a.c,
        m = a.mb.cp;
    b.l = function () {
        b.isShowed = !1;
        d = _$("#pageZoom");
        i = _$(".zoom", d);
        h = i.parentNode;
        j = h.parentNode;
        g = a.mb.gzs();
        b.mz = 0.5;
        b.mxz = 1.5;
        b.cz = 1;
        for (var k = d.querySelectorAll(".pageZoomControl TD"), n = 0; n < k.length; n++) k[n].addEventListener("click", function (a) {
            setTimeout(function () {
                (b[a.target.id] || $log.warn)(a)
            }, 0)
        });
        c || (l.addEventListener("gesturestart", function (c) {
            c.preventDefault();
            c.stopPropagation();
            a.d = !0;
            h.sC.d = !0;
            f = c.scale
        }), l.addEventListener("gesturechange", function (a) {
            if (!(a.scale - f < 0.3 && f - a.scale < 0.1)) a.preventDefault(), a.stopPropagation(), b.isShowed || e(a.pageX), b["cpz" + (a.scale - f > 0 ? "In" : "Out")](), f = a.scale
        }), l.addEventListener("gestureend", function (c) {
            c.preventDefault();
            c.stopPropagation();
            a.d = !1;
            h.sC.d = !1
        }), l.addEventListener("click", function (c) {
            if (a.ira && !(a.mo.isLandscape && c.x > a.grs("Width") || !a.mo.isLandscape && c.y > a.grs("Height"))) this.touchStarted && new Date - this.touchStarted < 200 ? (e(c.x), this.touchStarted = !1, b[b.isShowed ? "cpzClose" : "show"]()) : this.touchStarted = new Date
        }), c = !0)
    };
    b.i = function () {
        i.led = !1;
        a.mh.rH(i);
        i.index = a.ips(m) ? m : a.mb.cp;
        $dom.size(i, g.width, g.height);
        i.style.webkitBackgroundSize = g.width + "px " + g.height + "px";
        $dom.p(i, _$sbt(a.mb.url.zoom, [i.index]), _$sbt(a.mb.url.page, [i.index]), a.mh.sH)
    };
    b.show = function (c) {
        b.i();
        a.mb.settings.hideControlbar && a.msp.hideCtrlBar();
        $dom.show(d);
        b.zoom(c || 1);
        $dom.size(j, g.width * b.mxz, g.height * b.mxz);
        $dom.move(h, 0, g.height / 4);
        var c = a.gps("Width"),
            e = a.gps("Height"),
            f = j.parentNode._scrollWidth = Math.max(g.width * b.mxz, c),
            i = j.parentNode._scrollHeight = Math.max(g.height * b.mxz, e),
            m = h.sC.d;
        h.sC.d = !1;
        h.sC.refresh(!1, [-Math.ceil((f > c ? f - c : 0) / 2), -Math.ceil((i > e ? i - e : 0) / 2)]);
        h.sC.d = m;
        b.isShowed = !0
    };
    b.cpzClose = function () {
        a.mh.rH(i);
        $dom.hide(d);
        b.isShowed = !1
    };
    b.cpzIn = function () {
        b.isShowed ? b.zoom(b.cz + ZP) : b.show(b.mz)
    };
    b.cpzOut = function () {
        b.zoom(b.cz - ZP) || b.cpzClose()
    };
    b.zoom = function (a) {
        if (a < b.mz || a > b.mxz || b.cz == a) return !1;
        b.cz = a;
        $wkit.scale(h, b.cz, !0);
        $dom.uC(_$("#cpzOut"), "cDisabled", b.mz == b.cz);
        $dom.uC(_$("#cpzIn"), "cDisabled", b.mxz == b.cz);
        return !0
    };
    return b
}

function co(a) {
    function e() {
        if (i) h = !0;
        else {
            i = !0;
            h = !1;
            var g;
            g = a.gps("Width");
            var c = a.gps("Height");
            f == g && d == c ? g = !1 : (f = g, d = c, g = !0);
            g && ($dom.rC(document.body, b.lastOrient), $dom.aC(document.body, b.curOrient), a.irc ? a.dl() : a.i());
            i = !1;
            h && e()
        }
    }
    var b = this,
        f, d, i = !1,
        h = !1,
        j = !1;
    b.__defineGetter__("isLandscape", function () {
        return f > d
    });
    b.__defineGetter__("p", function () {
        return !b.lp
    });
    b.__defineGetter__("lp", function () {
        return j ? !1 : b.isLandscape
    });
    b.__defineGetter__("curOrient", function () {
        return j ? b.isLandscape ? OP_FORCED : OP : b.p ? OP : OL
    });
    b.__defineGetter__("lastOrient", function () {
        return j ? b.isLandscape ? OP : OP_FORCED : b.p ? OL : OP
    });
    b.l = function () {
        f = d = 0;
        j = a.mb.settings && a.mb.settings.singlePageInLandscape && a.mb._imgSizes[0] > a.mb._imgSizes[1];
        i = h = !1;
        b._iid == void 0 ? (e(), $ua.iP(), b._iid = setInterval(function () {
            e()
        }, OCI)) : e()
    };
    return b
}

function cBookmarkScreen(a) {
    function e() {
        var d = _$("DIV#bookmarks UL.jUL", b);
        d.addEventListener("click", function (b) {
            b = b.target;
            if (b.tagName != "LI") b = b.parentNode;
            b.tagName == "LI" && (a.mb.gtp(parseInt(b.getAttribute("data"))), a.msp.goBack(!0))
        });
        d.inneHTML = "";
        $dom.list(d, f.length, "LI", function (a, b) {
            var d = f[b];
            a.innerHTML = _$sbt('<DIV style="margin-left:{0}px;">{1}</DIV><small class="counter">{2}</small>', [d.subNode ? 20 : 0, d.id, b + 1]);
            a.setAttribute("data", d.page)
        });
        d.sC.refresh(!0)
    }
    var b, f = a.mb.marks;
    this.l = function () {
        b = _$("#scrBookmark");
        (f = a.mb.marks) && setTimeout(e, 0)
    };
    this.display = function (d) {
        a.msp[d ? "goToScreen" : "goBack"](b)
    };
    return this
}

function cis(a) {
    var e = this,
        b, f, d, i, h = a.mb._imgSizes[0],
        j = a.mb._imgSizes[1];
    e.l = function () {
        b = _$("#scrIndex");
        f = _$("#bookIndex", b);
        d = f.parentNode.parentNode;
        i = d._scrollHeight = 0;
        f.addEventListener("click", function (b) {
            b = parseInt(b.target.id.replace("index", ""));
            isNaN(b) || (a.mb.gtp(b), a.msp.goBack(!0))
        });
        f.sC.onScrollEnd = function (e) {
            var c = a.mb.pages.length;
            if ($dom.hC(b, "jCurrent") && i < c) {
                var l = Math.ceil(a.grs("Width") * a.grs("Height") / (h * (j + 20)));
                i && (l /= 4);
                for (var m = i + 1; m <= Math.min(i + l, c); m++) {
                    var k = document.createElement("div");
                    k.innerText = a.loc("lblPage", null, "general") + " " + m;
                    $dom.size(k, h, j);
                    k.style.lineHeight = j * 2 + 17 + "px";
                    k.style.marginBottom = -j + "px";
                    k.style.webkitBackgroundSize = h + "px " + j + "px";
                    k.id = "index" + m;
                    f.appendChild(k);
                    $dom.p(k, _$sbt(a.mb.url.thumb, [m]))
                }
                i = m - 1
            }
            d._scrollHeight = (Math.ceil(i / Math.floor(a.grs("Width") / (h + 10))) + 1) * (j + 17);
            e.i()
        }
    };
    e.dl = function () {
        f.style.width = a.gps("Width") + "px";
        setTimeout(function () {
            f.sC.refresh(!0)
        }, 0)
    };
    e.display = function (b) {
        b ? a.msp.goToScreen("scrIndex", "slideup", void 0, e.dl) : a.msp.goBack()
    };
    return e
}

function csrs(a) {
    function e(b) {
        var c = "<DIV>{2}. " + a.loc("lblPage", null, "general") + " {0}</DIV><small class='counter'>{1}</small>";
        a.msp.goToScreen("scrSearchResults", void 0, void 0, function () {
            var d = _$("DIV#searchResults UL.jUL"),
                e = d.parentNode.parentNode;
            d.addEventListener("click", function (c) {
                c = c.target;
                if (c.tagName != "LI") c = c.parentNode;
                c.tagName == "LI" && (a.mb.gtp(parseInt(c.getAttribute("data"))), a.msp.goBack(!0), a.mtr.display(!0, h.getSearchTerm()))
            });
            $dom.list(d, b.length, "LI", function (a, d) {
                var e = b[d];
                a.innerHTML = _$sbt(c, [e.id + 1, e._occur, d + 1]);
                a.setAttribute("data", e.id + 1)
            });
            d.parentNode.style.height = d.offsetHeight + "px";
            e._scrollHeight = e.scrollHeight + TTBH;
            d.sC.refresh(!0)
        })
    }

    function b(b) {
        b.preventDefault();
        var c = (b = h.getSearchTerm()) && b.length > 1;
        c || i(a.loc("lblEnterCorrectTerm", null, "search"), !0);
        c && (h.dom.tiSearch.blur(), b = a.mb.fp(b), c = b.length > 0 ? "lblResults" : "lblNoMatchesFound", c = a.loc(c, [b.length], "search"), i(c), b.length > 0 && e(b))
    }

    function f() {
        $dom.rA(h.dom.lblResult);
        h.dom.tiSearch.value = "";
        h.dom.tiSearch.focus()
    }

    function d(a) {
        a.keyCode == 13 && b(a)
    }

    function i(a, c) {
        var b = h.dom.lblResult;
        b.innerText = a;
        b.style.display = "block";
        b.style.color = c ? "red" : "black"
    }
    var h = this,
        j;
    h.l = function () {
        j = _$("#scrSearch");
        $dom.i(j, h, {
            lblResult: "H2",
            tiSearch: "#search",
            btnSearch: ".search",
            btnClear: ".clear"
        });
        h.dom.btnSearch.addEventListener("click", b);
        h.dom.btnClear.addEventListener("click", f);
        h.dom.tiSearch.addEventListener("keydown", d)
    };
    h.getSearchTerm = function () {
        return h.dom.tiSearch.value
    };
    h.display = function (b) {
        b ? a.msp.goToScreen(j, void 0, void 0, function () {
            a.IsRegularCall && h.dom.tiSearch.focus()
        }) : a.msp.goBack()
    };
    return h
}

function css(a) {
    function e() {
        d.location = _$sbt(appConfig.tmlSocEmail, [a.mb.gbu(), _$gW1(a.mb.cb)])
    }
    var b = this,
        f, d = a.c;
    b.navigate = function (b) {
        b = (typeof b != "object" ? b : b.currentTarget.id.substr(2)).toLowerCase();
        b = EM.U.sbt(appConfig.socBookmarks[b].url, [a.mb.gbu(), encodeURIComponent(a.mb.cb)]);
        if (!d.open(b)) d.location = b
    };
    b.display = function (b) {
        if (b) {
            var d = _$("#socBookmarks");
            a.msp.goToScreen(f, "slideup", void 0, function () {
                d._scrollHeight = d.scrollHeight + TTBH;
                _$("#socBookmarks UL").sC.refresh()
            })
        } else a.msp.goBack()
    };
    b.l = function () {
        f = _$("#scrShare");
        $dom.i(f, b, {
            btnMailTo: "#mailto"
        });
        b.dom.btnMailTo.addEventListener("click", e);
        for (var a = f.querySelectorAll("UL.jUL>LI"), d = 0; d < a.length; d++) a[d].addEventListener("click", b.navigate)
    };
    return b
}

function ctr(a) {
    function e(a, b) {
        return (d = b) ? a.replace(RegExp("(" + b.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g, "\\$1") + ")", "gi"), "<MARK>$1</MARK>") : a
    }
    var b = this,
        f, d, i = a.loc("lblPageText"),
        h = a.loc("lblNoTextOnThisPage"),
        j, g;
    b.l = function () {
        f = !1;
        j = _$("#readerText");
        g = _$("#readerText p")
    };
    b.i = function (c) {
        if (f) {
            var b = a.mb,
                j = b.cp - b.cp % b.pageStep || 1,
                k = (j || 1) - 1,
                c = c == void 0 ? d : c,
                n = _$sbt(i, [j, e(b.pages[k].text, c) || h]);
            a.mo.lp && b.pages.length > k + 1 && (n += _$sbt(i, [j + 1, e(b.pages[k + 1].text, c) || h]));
            g.innerHTML = n;
            g.sC.refresh()
        }
    };
    b.display = function (c, d) {
        function e(a) {
            $dom[c ? "aC" : "rC"](_$("#cp_" + a), "textViewMode")
        }
        f = c;
        e("H");
        e("V");
        a.msp[c ? "goToScreen" : "goBack"](j, "pop", 0, function () {
            b.i(d || "")
        })
    };
    b.dl = function () {
        $dom.size(j, a.grs("Width"), a.grs("Height"))
    };
    return b
}

function cSecurityManager(a) {
    function e(a, c, b, d) {
        $log.info("Read data from server: " + $xml.toString(c));
        return _$get(a, b, d, '<?xml version="1.0" encoding="utf-8"?>' + $xml.toString(c), !0, "post", !0)
    }

    function b(a, c, b) {
        return c["SOAP-ENV:Envelope"]["SOAP-ENV:Body"]["ns1:Webservices" + a + "." + b + "Response"]["return"]
    }

    function f(a, c) {
        return c ? a[c]["#text"] : a["#text"]
    }
    var d = this,
        i = !1,
        h, j = $soap.createRequest("urn:WebservicesPortalEmags", "getEmagIdByHash", {
            pdf_hash: $soap.createField("string", a.mb.settings.mph),
            userid_hash: $soap.createField("string", a.mb.settings.muid)
        });
    //UPD
    d.sendRequest = e;

    d.getEMagID = function (d) {
        return e("http://portal.emagstudio.com/API/mobileAPI.php?t=WebservicesPortalEmags&wsdl", j, function (c) {
            var e;
            e = $xml.toJSONObject(c);
            if (e = b("PortalEmags", e, "getEmagIdByHash").response) return d(f(e, ""));
            c = $xml.toJSONObject(c);
            if (e = b(c, "getEmagIdByHash", void 0).error) return a.sa("Error!", f(e, "description"));
            a.sa("System Error!", "Internal error occured, please contact support.")
        }, function (a) {
            $log.info("cSOAPClient.getAppData error: " + a)
        })
    };
    d.getFromPortal = function (d, c, h) {
        return e("http://portal.emagstudio.com/API/mobileAPI.php?t=WebservicesPortalAccessProtection&wsdl", d, function (d) {
            var e;
            e = $xml.toJSONObject(d);
            if (e = b("PortalAccessProtection", e, c).response) return h(e);
            d = $xml.toJSONObject(d);
            if (e = b(d, c, void 0).error) return a.sa("Error!", f(e, "description"));
            a.sa("System Error!", "Internal error occured, please contact support.")
        }, function (a) {
            $log.info("cSOAPClient.getAppData error: " + a)
        })
    };
    //UPD
    d.getFromPortalBeta = function (d, c, h) {
        return e("http://beta.portal.emagstudio.com/API/mobileAPI.php?t=WebservicesPortalAccessProtection&wsdl", d, function (d) {
            var e;
            e = $xml.toJSONObject(d);
            if (e = b("PortalAccessProtection", e, c).response) return h(e);
            d = $xml.toJSONObject(d);
            if (e = b(d, c, void 0).error) return a.sa("Error!", f(e, "description"));
            a.sa("System Error!", "Internal error occured, please contact support.")
        }, function (a) {
            $log.info("cSOAPClient.getAppData error: " + a)
        })
    };
    d.i = function () {
        var b = _$("#acProtection").sC,
            c = b.owner.parentNode;
        c.style.width = a.gps("Width") + "px";
        c._scrollHeight = _$("#acProtection").offsetHeight + ($ua.iP() ? 200 + ($ua.iPad() ? 400 : 0) : 40);
        b.refresh()
    };
    d.l = function () {
        h = _$("#scrAP")
    };
    d.show = function () {
        a.mb.settings.mph && !i && !appConfig.basePath && d.getEMagID(function (b) {
            if (b == 0) i = !0;
            else return b = $soap.createRequest("urn:WebservicesPortalAccessProtection", "checkExistance", {
                emag_id: $soap.createField("string", b)
            }), d.getFromPortal(b, "checkExistance", function (c) {
                if (f(c, "exists") == 0) i = !0;
                else {
                    var b = f(c, "message"),
                        e = f(c, "profile_id"),
                        g = _$("#acProtection", h),
                        n = _$("#Submit", g),
                        j = _$("input[type=text]", g),
                        p = _$("input[type=password]", g),
                        o = _$(".errorMessage", g),
                        r;
                    n.innerHTML = a.loc("accessProtectionCredentialsFormSubmit", null, "accessprotection_plugin");
                    _$(".message", g).innerHTML = $crypt.b64decode(b);
                    j.placeholder = a.loc("accessProtectionCredentialsFormLogin", null, "accessprotection_plugin");
                    p.placeholder = a.loc("accessProtectionCredentialsFormPassword", null, "accessprotection_plugin");
                    p.addEventListener("keydown", function (a) {
                        a.keyCode == 13 && n.click()
                    });
                    j.addEventListener("click", function () {
                        this.focus()
                    });
                    p.addEventListener("click", function () {
                        this.focus()
                    });
                    n.addEventListener("click", function () {
                        $dom.hide(o);
                        if (j.value)
                            if (p.value) {
                                var c = $soap.createRequest("urn:WebservicesPortalAccessProtection", "checkPassword", {
                                    profile_id: $soap.createField("string", e),
                                    login: $soap.createField("string", j.value),
                                    password: $soap.createField("string", p.value)
                                });
                                o.innerHTML = a.loc("accessProtectionCredentialCheckPleaseWait", null, "accessprotection_plugin");
                                $dom.show(o);
                                return d.getFromPortal(c, "checkPassword", function (c) {
                                    f(c, "exists") == 1 ? (a.msp.goBack(h), i = !0, clearInterval(r)) : (o.innerHTML = a.loc("accessProtectionCredentialCheckFailed", null, "accessprotection_plugin"), $dom.show(o))
                                })
                            } else o.innerHTML = a.loc("accessProtectionNoPassword", null, "accessprotection_plugin"), $dom.show(o);
                            else o.innerHTML = a.loc("accessProtectionNoLogin", null, "accessprotection_plugin"), $dom.show(o)
                    });
                    a.msp.goToScreen(h, "slideup", void 0, function () {
                        var a = _$("#acProtection").sC;
                        a.owner.parentNode._scrollHeight = g.offsetHeight + ($ua.iP() ? 200 + ($ua.iPad() ? 400 : 0) : 40);
                        a.lockedClick = $ua.iP() || $ua.chrome();
                        a.refresh(!0);
                        r = setInterval(function () {
                            a.owner.offsetHeight < g.offsetHeight + ($ua.iP() ? 200 + ($ua.iPad() ? 400 : 0) : 40) && d.i()
                        }, 1E3)
                    })
                }
            })
        })
    };
    return d
}

function csp(a) {
    var e = new cspBase,
        b = !1,
        f = null,
        d = !1,
        i = {
            PgNext: {
                obj: "mb",
                mtd: "n",
                prm: null,
                ssb: 0
            },
            PgPrev: {
                obj: "mb",
                mtd: "p",
                prm: null,
                ssb: 0
            },
            PgZoom: {
                obj: "mz",
                mtd: "show",
                prm: null,
                ssb: 0
            },
            Text: {
                obj: "mtr",
                mtd: "display",
                prm: !0,
                ssb: 0
            },
            Image: {
                obj: "mtr",
                mtd: "display",
                prm: !1,
                ssb: 0
            },
            Menu: {
                obj: "msp",
                mtd: "showMenu",
                prm: null,
                ssb: 1
            },
            PgGoTo: {
                obj: "msp",
                mtd: "PgGoTo",
                prm: null,
                ssb: 1
            },
            Index: {
                obj: "mi",
                mtd: "display",
                prm: !0,
                ssb: 1
            },
            Share: {
                obj: "msc",
                mtd: "display",
                prm: !0,
                ssb: 1
            },
            Search: {
                obj: "msr",
                mtd: "display",
                prm: !0,
                ssb: 1
            },
            Bookmarks: {
                obj: "mbmark",
                mtd: "display",
                prm: !0,
                ssb: 1
            },
            Security: {
                obj: "mngSecurity",
                mtd: "show",
                prm: !0,
                ssb: 1
            }
        };
    e.isCtrlBarShowed = !1;
    e.hideCtrlBar = function () {
        e.isCtrlBarShowed = !1;
        _$("#cp_V").style.width = "0";
        _$("#cp_H").style.bottom = "-49px"
    };
    e.processCommand = function (b, e) {
        d || (d = !0, b && (a.mz.isShowed && a.mz.cpzClose(), f = i[b], a[f.obj][f.mtd](f.prm || e)), d = !1)
    };
    e.goToScreen_i = e.goToScreen;
    e.goToScreen = function (a, b, d, c) {
        setTimeout(function () {
            if (d === void 0 && f) d = f.ssb;
            e.goToScreen_i(a, b, d, c)
        }, 0)
    };
    e.showMenu = function () {
        e.goToScreen("scrMenu", "slideup", void 0, function () {
            _$("#menuItems")._scrollHeight = _$("#menuItems").scrollHeight + TTBH;
            var a = _$("#cpm").sC;
            a.lockedClick = !0;
            a.refresh()
        })
    };
    e.PgGoTo = function (b) {
        a.sp(a.loc("lblGoToPage", [a.mb.cp, a.mb.pages.length]), a.mb.cp, function (b) {
            b = parseInt(b);
            if (!b || 0 >= b || b > a.mb.pages.length) return !1;
            a.mb.gtp(b);
            e.goBack(!0);
            return !0
        }, b)
    };
    e.l_i = e.l;
    e.l = function () {
        e.l_i();
        var d = !1,
            f, g = a.dom.reader.parentNode;
        a.mb.settings.hideControlbar && e.hideCtrlBar();
        b || (document.body.addEventListener("touchmove", function (a) {
            a.preventDefault()
        }), b = !0);
        for (var c = _$("#cp_H TD, #cp_V TD", a.dom, !0, !0), i = 0; i < c.length; i++) c[i].addEventListener("click", function (c) {
            c.preventDefault();
            c.stopPropagation();
            c = c.target.parentNode;
            e.processCommand(((a.mo.isLandscape ? c.parentNode.id : c.id) || "").substr(3))
        });
        c = _$("#cpm LI", a.dom, !0, !0);
        for (i = 0; i < c.length; i++) c[i].addEventListener("click", function (a) {
            a.preventDefault();
            a.stopPropagation();
            e.processCommand(a.currentTarget.id.substr(3), a) && e.goBack(!0)
        });
        g.addEventListener("mousedown", function () {
            e.moved = !1;
            d = !0
        }, !0);
        g.addEventListener("mousemove", function () {
            e.moved = d
        }, !0);
        g.addEventListener("mouseup", function () {
            d = !1
        }, !0);
        g.addEventListener("click", function () {
            !a.mb.settings.hideControlbar || e.moved || f ? f = e.moved = !1 : (f = !0, $dom.transitionEndHandle(_$("#cp_V"), function () {
                f = !1
            }), $dom.transitionEndHandle(_$("#cp_H"), function () {
                f = !1
            }), e.isCtrlBarShowed ? e.hideCtrlBar() : (e.isCtrlBarShowed = !0, _$("#cp_V").style.width = "", _$("#cp_H").style.bottom = ""))
        });
        c = _$(".toolbar>.cancel", a.dom.ctr, !0, !0);
        for (i = 0; i < c.length; i++) c[i].addEventListener("click", function (a) {
            a.preventDefault();
            a.stopPropagation();
            e.goBack()
        });
        _$("#enterPageNum").addEventListener("click", function (a) {
            a.preventDefault();
            a.stopPropagation();
            e.processCommand("PgGoTo")
        })
    };
    return e
}

function csm(a) {
    var e;

    function b() {
        var b = a.mb.cp;
        return Math.min(Math.max(b - b % 2 - Math.ceil(c / 2), 0), j - c + (j == c || j % 2 ? 0 : 1))
    }

    function f(c) {
        var d;
        d = a.mb.cp;
        d = a.gtws("Width") * (d - (a.mo.p ? 1 : d % 2));
        var e = a.gtws("Width") * (b() + Number(a.mo.lp));
        return (c ? d : e) - SHR * Math.floor(Math.min(d, e) / SHR)
    }
    var d = this,
        i, h = [{
            selector: "#rdr",
            vScroll: !1,
            hScroll: !0,
            hideBar: !0
        }, {
            selector: "#searchResults ul",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#readerText p",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#zoomContainer",
            vScroll: !0,
            hScroll: !0,
            hideBar: !1
        }, {
            selector: "#bookIndex",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#cpm",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#scrShare ul",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#scrBookmark ul",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }, {
            selector: "#acProtection",
            vScroll: !0,
            hScroll: !1,
            hideBar: !1
        }],
        j, g, c, l;
    d.l = function () {
        e = void 0;
        i = [];
        l = null;
        g = [];
        c = 0;
        j = a.mb.pages.length;
        for (var b = 0; b < h.length; b++) {
            var d = _$(h[b].selector, a.dom);
            if (d && !d.sC) d.sC = i[b] = new csc(d.parentNode, h[b].hScroll, h[b].vScroll, h[b].hideBar)
        }
    };
    d.i = function () {
        e = void 0;
        if (a.pagerType == PT_SCROLL) a.dom.ctr._scrollWidth = a.gtws("Width") * (j + a.mb.pageStep) + CPW, $dom.size(a.dom.reader, a.grs("Width"), a.grs("Height"));
        for (var c = 0; c < i.length; c++) i[c] && i[c].refresh(!0)
    };
    d.initPageScroller = function (h) {
        var k = a.mb;
        h.touchStart = function (a, c) {
            if (k.frozenSide == void 0) c.stt("0"), c.invoke("setScrollStart"), c.invoke("setTouchStart", a), h.timeStart = a.timeStamp
        };
        h.touchMove = function (c, b) {
            if (h.timeStart) b.setPos(b.invoke("getMovePos", c)), b.invoke("setTouchStart", c), a.msp.moved = !0
        };
        h.touchEnd = function (c, b) {
            if (h.timeStart) {
                var d = b.invoke("getLey", c.timeStamp - h.timeStart > 500 ? a.grs("Width") / 3 : 0)[0],
                    e = Math.min(Math.max(d * k.pageStep + k.cp, 1), j);
                k.frozenSide = e - 2 <= g[1].image.index && d < 0 && e != 1 ? !1 : e >= g[g.length - 1].image.index && g[g.length - 1].image.index > g[g.length - 2].image.index && d > 0 && e != k.pages.length ? !0 : void 0;
                k.gtp(e) || (b.stt("450ms"), b.setPos(b.invoke("getScrollStart")), $dom.dispatchClick(c));
                h.timeStart = null
            }
        };
        h.onScrollEnd = function () {
            if (!h.inQueue) {
                k.pPages = g;
                var n = a.mh.sH,
                    i = Math.floor(c / 4),
                    p = parseInt(l.style.width);
                if (e && (a.ips(e) || k.cp <= e + i && k.cp >= e - i || g.length >= j) && p < 95E3 && p > 5E3)
                    for (var i = d.showedPages, o = 0; o < i.length; o++) n(i[o].image), k.frozenSide = void 0;
                else {
                    e || (a.mb.jumpToPage = !0);
                    e = k.cp;
                    h.shift = a.mo.p;
                    var i = b(),
                        r = f();
                    h.inQueue = !0;
                    for (o = 1; o < g.length; o++) p = g[o], p.lc = a.ips(++i) ? function (a) {
                        h.shift ? $dom.size(l, r, 0) : h.shift = !0;
                        n(a);
                        k.frozenSide = void 0
                    } : function (a) {
                        n(a);
                        if (k.frozenSide && o >= g.length - 1) k.frozenSide = void 0
                    }, p.index = i;
                    a.mb.jumpToPage && $dom.size(l, r, 0);
                    h.inQueue = !1
                }
            }
        };
        h.initDimentions = function () {
            h.psW = a.gps("Width");
            h.tsW = a.gts("Width");
            h.tsH = a.gts("Height");
            h.twsW = a.gtws("Width")
        };
        h.iThumbnails = function () {
            function b(c, d) {
                var e = c.parentNode.label,
                    f = h.twsW - h.tsW;
                if (!c.dvLoad) c.style.webkitBackgroundSize = h.tsW + "px " + h.tsH + "px";
                c.style.margin = d == 1 && !a.mo.lp ? "0 " + f + "px 0 " + f / 2 + "px" : d % 2 || !a.mo.lp ? "0 " + f * (a.mo.lp ? 2 : 1) + "px 0 0" : "0";
                e.style.paddingRight = h.psW - h.tsW + h.tsW / 2 + "px"
            }
            var d = _$("#pages", a.dom.reader);
            h.initDimentions();
            if (c) var e = function (a) {
                if (a) {
                    var c = g[a].image;
                    $dom.size(c, h.tsW, h.tsH);
                    b(c, a)
                }
            };
            else {
                e = CPC * 2;
                e <= j && (e = CPC);
                g = Array(Math.min(j + 1, e));
                c = g.length - 1;
                var f = _$("#pageNums", a.dom.reader),
                    i = document.createElement("td"),
                    u = document.createElement("td"),
                    s = document.createElement("div"),
                    e = function (c) {
                        var e = g[c] = u.cloneNode(!0);
                        e.__defineGetter__("index", function () {
                            return this.image.index || 0
                        });
                        e.__defineSetter__("index", function (d) {
                            !d || this.image.index == d ? this.lc(this.image) : d <= j ? (a.mh.rH(this.image), this.label.innerHTML = this.image.index = d, b(this.image, c), $dom.p(this.image, _$sbt(k.url.page, [d]), null, this.lc)) : (this.label.innerHTML = "", this.image.style.webkitBackgroundSize = "0px 0px", a.mh.rH(this.image))
                        });
                        e.label = i.cloneNode(!0);
                        e.image = e.childNodes[0];
                        k.settings.showPageNumbers && f.appendChild(e.label);
                        d.appendChild(e)
                    };
                if (k.settings.showPageNumbers) u.style.verticalAlign = "top", f.style.display = "table-row";
                $dom.size(s, h.tsW, h.tsH);
                s.style.webkitBackgroundSize = h.tsW + "px " + h.tsH + "px";
                u.appendChild(s)
            }
            for (s = 0; s < g.length; s++) e(s);
            l = g[0].image
        };
        h.dp = function () {
            h.setPosition([f(!0), 0])
        };
        $dom.show(h.owner);
        return h
    };
    d.__defineGetter__("showedPages", function () {
        var c = a.mb.cp,
            b = c - g[1].index + 1,
            d = [g[b]];
        if (a.mo.lp && (c % 2 || c != j)) d.push(g[b + (c % 2 ? -1 : 1)]);
        return d
    });
    return d
}

function cPageFlipper(a) {
    function e() {
        return {
            width: a.gts("Width"),
            height: a.gts("Height")
        }
    }

    function b() {
        var b, d = !0,
            f, i = top.$("#trdr"),
            q = !1,
            p, o = function (a) {
                return h.pages.length - 8 >= 0 || h.cp > 1 || a % 2 == 1
            }, r = function (c) {
                return !((a.mo.isLandscape && h.pages.length % 2 && h.cp + (h.cp % 2 ? 0 : 1) >= h.pages.length || a.mo.p && h.cp >= h.pages.length) && c == 7)
            };
        c = _$("DIV", i[0], !1, !0);
        h.pPages = c;
        top.$(i[0]).bind($ua.isTouch() ? "touchstart" : "mousedown", function (a) {
            i.d || (a = $ua.isTouch() ? a.originalEvent.touches : [a.originalEvent], b = a[0] ? {
                x: a[0].pageX,
                y: a[0].pageY
            } : null, f = null)
        }).bind($ua.isTouch() ? "touchmove" : "mousemove", function (a) {
            if (!i.d) {
                var c = $ua.isTouch() ? a.originalEvent.touches : [a.originalEvent];
                c.length == 1 && a.preventDefault();
                f = c[0] ? {
                    x: c[0].pageX,
                    y: c[0].pageY
                } : null
            }
        }).bind($ua.isTouch() ? "touchend" : "mouseup", function (c) {
            function d() {
                c.preventDefault();
                c.stopPropagation();
                $dom.dispatchClick(c.originalEvent)
            }
            if (!a.mz.isShowed && !i.d && !q) {
                q = !0;
                if (b && f) {
                    var e = f.x - b.x;
                    Math.abs(f.y - b.y) < 100 && (e > 100 ? o(i.turn("page")) ? i.turn("previous") : d() : e < 100 ? r(i.turn("page")) ? i.turn("next") : d() : d())
                } else a.ira && d();
                q = !1
            }
        }).bind("turned", function (a, c) {
            q = !1;
            if (!d) i.onPageChanged(i.lastPage < c)
        }).bind("start", function (a, c) {
            p = c;
            if (!o(c.page) || !r(c.page)) a.preventDefault(), a.stopPropagation(), i.turn("stop")
        });
        i[0].addEventListener("click", function (c) {
            var b = c.offsetX,
                c = c.offsetY;
            if (p && (o(p.page) && (b < 100 && c < 100 || b < 100 && c > a.gts("Height") - 100) || r(p.page) && (b > a.gts("Width") - 100 && c < 100 || b > a.gts("Width") - 100 && c > a.gts("Height") - 100))) a.msp.moved = !0
        });
        i.dp = function (b) {
            if (b || h.cp != i.cp) {
                i.cp = h.cp;
                for (var e = a.mo.lp, f = h.pages.length, k = Math.min(h.cp + (e ? h.cp % 2 ? 0 : 1 : 0), f), q = e ? Math.min(Math.max(k - 4, 1), f - (f % 2 ? 6 : 7)) : Math.min(Math.max(k - 1, 1), f - 3), l = function (c) {
                        (a.mo.lp || a.mo.p && parseInt(c.id.substr(1)) % 2) && g(c);
                        if (k == c.index) d = !0, i.lastPage = e ? q == 1 ? k : (q >= f - (f % 2 ? 6 : 7) ? k - q : 4) + 1 : q == 1 ? k * 2 - 1 : (q >= f - 3 ? (k - q) * 2 : 2) + 1, i.turn("page", i.lastPage).turn("stop"), d = !1, h.frozenSide = void 0
                    }, p = 0; p < c.length; p++) b = q + (a.mo.lp ? p : Math.floor(p / 2)), c[p].index != b ? (j(c[p]), c[p].index = b, b > 0 && b <= f ? $dom.p(c[p], _$sbt(h.url.page, [b > f ? f : b]), null, l) : c[p].style.backgroundImage = "") : setTimeout(l, 100, c[p])
            }
        };
        i.iThumbnails = function () {
            var b = e();
            i.turn("size", b.width * 2, b.height);
            $dom.move(i[0], (a.grs("Width") - b.width * 2) / 2 - (a.mo.lp ? 0 : b.width / 2), (a.grs("Height") - b.height) / 2);
            for (var d = 0; d < c.length; d++) $dom.size(c[d], b.width, b.height), c[d].style.webkitBackgroundSize = b.width + "px " + b.height + "px"
        };
        i.onPageChanged = function (c) {
            d || h.gtp(Math.min(Math.max(h.cp + (c ? 1 : -1) * (a.mo.lp ? 2 : 1), 1), h.pages.length))
        };
        i.__defineSetter__("d", function (a) {
            i.turn("disable", a)
        });
        i.turn({
            acceleration: !0,
            shadows: !0
        });
        d = !1;
        return i
    }

    function f() {
        return a.ms.initPageScroller(a.dom.reader.sC)
    }

    function d() {
        var c = a.dom.reader,
            b = new top.c3DFlipper(c, 4, e()),
            d = [
                [0, 1, 2, 3],
                [0, 1, 2, -1],
                [0, 1, -1, -2],
                [0, -1, -2, -3]
            ];
        b.iThumbnails = function () {
            c.width = a.grs("Width");
            c.height = a.grs("Height");
            b.lp = a.mo.lp;
            b.pageSize = e();
            b.ctr.frame()
        };
        b.onPageChanged = function (a) {
            h.gtp(Math.max(h.cp + (a ? 2 : -2), 1))
        };
        b.dp = function (a) {
            var c = b.pagesTop.right || b.pagesTop.left,
                e = h.cp,
                f, i = d[h.fi ? 0 : e <= 3 ? 1 : h.il ? 3 : 2];
            e += e % 2 ? 0 : 1;
            for (var l = 0; l < 4; l++) {
                c.order = i[l];
                f = e + i[l] * 2;
                if (a || !c.index || c.index != f) {
                    c.holders = [];
                    j(c, c.index);
                    j(c, c.index + 1);
                    c.last = h.pages.length % 2 && h.il;
                    c.index = f;
                    for (var s = 0; s < 2; s++) g(c, f + s), _$p(_$sbt(h.url.page, [f + s]), function (a, c) {
                        c.page.textures[c.index] = a;
                        c.page.led ? (c.page.led = !1, c.page.build()) : c.page.led = !0;
                        b.ctr.frame()
                    }, {
                        page: c,
                        index: s
                    })
                }
                c = c.next
            }
        };
        return b
    }

    function i() {
        var c = a.dom.reader,
            b = new top.cWKFlipper(c);
        b.pageCount = h.pages.length;
        b.iThumbnails = function () {
            var b = a.gts("Width"),
                d = a.gts("Height"),
                e = a.mo.lp;
            $dom.size(c, b * 2, d);
            $dom.move(c, (a.grs("Width") - (e ? b * 2 : b)) / 2 - (e ? 0 : a.grs("Width") - (a.grs("Width") - b)), (a.grs("Height") - d) / 2);
            c.style.webkitPerspective = b * 6 + "px";
            for (var e = _$("DIV", c, !1, !0), f = 0; f < e.length; f++) $dom.size(e[f], b, d), e[f].style.webkitBackgroundSize = b + "px " + d + "px"
        };
        b.onPageChanged = function (a) {
            h.gtp(Math.max(h.cp + (a ? 2 : -2), 1))
        };
        b.dp = function () {
            function a(b, d, e) {
                for (var f = 0; f < 3; f++) {
                    var i = d != b.div.index;
                    if (i) j(b.div), b.div.index = d, $dom.rc(b, "fpage-" + (d != 1 ? "first" : "right"), "fpage-" + (d != 1 ? "right" : "first"));
                    d > 0 ? (b.display([c - 2, c, c + 1, c + 3].indexOf(d) >= 0), i ? $dom.p(b.div, _$sbt(h.url.page, [d]), null, g) : g(b.div)) : b.display(!1);
                    b = b.next;
                    d += e
                }
            }
            var c = h.cp;
            c -= c % 2;
            a(b.pagesTop[0].prev, c + 2, -2);
            a(b.pagesTop[1].prev, c - 1, 2)
        };
        $dom.show(c);
        return b
    }
    var h = a.mb,
        j = a.mh.rH,
        g = a.mh.sH,
        c;
    this.i = function () {
        return [f, i, d, b][a.pagerType]()
    };
    this.l = function () {
        _$jpk([
            [],
            ["cWKFliper"],
            ["c3D", "c3DFliper"],
            ["jquery", "turn"]
        ][a.pagerType])
    };
    return this
}

function cHM(a) {
    var e = this,
        b, f = {}, d = a.c,
        i = a.mb.docStage || [];
    e.eventHandlers = new cHolderEventHandlers(a);
    e.rH = function (a, d) {
        var e;
        if (b && (e = f[a.className == "zoom" ? "zoom" : "page"]) && (e = e["page" + (d || a.index)]))
            for (var c = 0; c < e.length; c++) e[c].remove(a)
    };
    e.sH = function (e, i) {
        if (b) {
            var g = i || e.index,
                c = "page" + g,
                l = b[c];
            if (l) {
                var m = e.className == "zoom" ? "zoom" : "page";
                if (f[m][c])
                    for (var k = 0; k < f[m][c].length; k++) f[m][c][k].show(e);
                else
                    for (var n, c = f[m][c] = [], k = 0; k < l.length; k++) {
                        var q;
                        n = l[k];
                        var p = g,
                            o = m;
                        if (n.className.split("::")[1] == "SlideShow" && n.properties.srcType == "SLIDESHARE") q = void 0;
                        else {
                            var r = "c" + (o != "zoom" && a.pagerType == PT_3DCANVAS ? "3D" : "") + n.className.split("::")[1];
                            d[r] ? q = r == "cVideoPlayer" && n.properties.videoSrc == "" ? null : new d[r](a, n, p, o) : $log.error('Page content holder class "' + r + '" is not available')
                        } if (n = q) c.push(n), n.i = c.length - 1, n.positionate(), n.show(e)
                    }
            }
        }
    };
    e.getSrc = function (b, d) {
        var e = b.toLowerCase();
        return e == "youtube" ? d : (e == "local" ? a.irc || a.isTest ? "./../../" : appConfig.dataUrl.split("pubData")[0] : "") + d.encodeFileName()
    };
    e.getHolderPropertyValue = function (a, b, d, c) {
        return f[a]["page" + b][d][c]
    };
    e.i = function () {
        var a = f.page,
            b;
        for (b in a)
            for (var d = 0; d < a[b].length; d++) a[b][d].positionate();
        e.eventHandlers.i()
    };
    e.l = function () {
        f = {
            page: {},
            zoom: {}
        };
        b = a.mb.pageHolders;
        for (var d = 0; d < i.length; d++)
            for (var j = i[d].actions, g = 0; g < j.length; g++) {
                var c = j[g].actionType.tMN();
                if (i[d].type.toLowerCase().indexOf("tick") >= 0) e.eventHandlers.timers[i[d].properties.message] = {
                    action: c,
                    timerId: null,
                    options: j[g]
                };
                else e.eventHandlers[c](j[g])
            }
    };
    return e
}

function cHolderEventHandlers(a) {
    var e = this,
        b = a.c,
        f, d, i, h, j = _$("#Player_AUDIO");
    j.addEventListener("loadeddata", j.play);
    e.timers = {};
    e.i = function () {
        var b = a.gps("Width"),
            c = a.gps("Height");
        f && f.resize(b, c);
        d && d.positionate();
        i && i.resize(b, c)
    };
    e.openExternalLink = function (a) {
        if (a.linkURL && !h) {
            h = !0;
            if (a.linkURL.substr(0, 6) == "mailto") b.location = a.linkURL;
            else if (a.linkURL.substr(0, 10) == "javascript") eval(a.linkURL.replace("javascript:", ""));
            else if (b.navigator.userAgent.indexOf("Maxthon") > -1) setTimeout(function () {
                b.open(a.linkURL, a.targetType)
            }, 20);
            else if (!b.open(a.linkURL, a.targetType)) b.location = a.linkURL;
            setTimeout(function () {
                h = !1
            }, 100)
        }
    };
    e.displayMessage = function (b) {
        f || (f = new cLayerScreen(a));
        f.appendHTML(b.message);
        f.setBackground("#FFF");
        f.canClose = b.canClose;
        f.show()
    };
    e.browsePdf = function () {
        b.open((a.irc || a.isTest ? "./../../" : appConfig.dataUrl.split("pubData")[0]) + a.mb.pdfPath)
    };
    e.gotoFirstPage = function () {
        a.mb.goToFirst()
    };
    e.gotoPrevPage = function () {
        a.mb.p()
    };
    e.gotoNextPage = function () {
        a.mb.n()
    };
    e.gotoLastPage = function () {
        a.mb.goToLast()
    };
    e.gotoPageN = function (b) {
        a.mb.gtp(b.pageNumber)
    };
    e.openIndexWindow = function () {
        a.msp.processCommand("Index")
    };
    e.openSearchWindow = function () {
        a.msp.processCommand("Search")
    };
    e.openAccessprotectionWindow = function () {
        a.msp.processCommand("Security")
    };
    e.playSound = function (b) {
        if (j.loopSound) {
            if (!b.loopSound) j.removeEventListener("ended", j.play), j.loopSound = !1
        } else if (b.loopSound) j.addEventListener("ended", j.play), j.loopSound = !0;
        j.src = a.mh.getSrc(b.soundSrcType, b.localSoundSrc || b.linkSoundSrc);
        j.volume = (b.soundVolume / 3).toFixed(2);
        j.play()
    };
    e.stopSound = function () {
        j.pause();
        j.currentTime = 0
    };
    e.openImageInWindow = function (b) {
        i = new cMP(a, "IMAGE", a.mh.getSrc("local", b.imageSource));
        i.onLoad = e.i;
        i.play()
    };
    e.openVideoInWindow = function (b) {
        i = new cMP(a, b.videoSrcType, a.mh.getSrc(b.videoSrcType, b.videoSrc));
        e.i();
        i.play()
    };
    e.openUrlWindow = function (b) {
        i = new cMP(a, "IFRAME", b.URL);
        if ($ua.iP() && b.scroller) i.close_i = i.close, i.close = function () {
            i.close_i();
            a.scroll = a.scroll_i;
            a.scroll_i = void 0
        }, i.play_i = i.play, i.play = function () {
            a.scroll_i = a.scroll;
            a.scroll = function (c) {
                (!c || a.ira) && a.scroll_i(c)
            };
            i.play_i()
        };
        e.i();
        i.play()
    };
    e.openSlideshowInWindow = function (b, c) {
        if (b.srcType != "SLIDESHARE") {
            f || (f = new cLayerScreen(a));
            if (!f.close_i) f.close_i = f.close;
            f.close = function () {
                f.close_i();
                c ? (c.itemIndex = d.itemIndex - (c.mode == "zoom" ? 0 : 1), c.p(c.prop.autoPlay ? c.play : c.pause), d.pause()) : d.stop();
                f.setTitle();
                f.close = f.close_i
            };
            b.itemIndex = 1;
            d && (c || d.prop != b) && d.remove(f.content);
            !d || d.prop != b || c ? (b.itemIndex = c ? c.itemIndex - 1 : 0, d = new cSlideShow(a, {
                className: "emc.slideShow::SlideShow",
                type: "inNewWindow",
                events: [],
                positioning: [],
                properties: b
            }, a.mb.cp, "page"), d.setDescription = f.setTitle) : d.itemIndex = c ? c.itemIndex - 1 : 1;
            f.appendHTML("");
            f.setBackground("#000");
            d.show(f.content);
            d.positionate();
            c && d.play(c.itemIndex);
            f.show()
        }
    };
    e.openSharethisWindow = function () {
        a.msp.processCommand("Share")
    };
    e.shareOn = function (b) {
        a.msc.navigate(b.shareOnType.split(".")[1].toLowerCase())
    };
    e.createTimer = function (a) {
        var c = e.timers[a.message];
        c.timerId = setTimeout(e[c.action], a.duration * 1E3, c.options)
    };
    e.removeAllTimers = function () {
        for (var a in e.timers) clearTimeout(e.timers[a].timerId)
    };
    return e
}

function cHB(a, e) {
    function b(a) {
        if (d.ips) {
            var c = a.offsetX,
                b = a.offsetY;
            c >= i && c <= j && b >= h && b <= g && d.events.click(a)
        }
    }

    function f(a, c, b) {
        if (!(e.mode == "zoom" && a == "load")) {
            d.events[a] = function (a) {
                a.type == "load" ? d.Holder.removeEventListener("load", arguments.callee) : (a.preventDefault(), a.stopPropagation());
                m[c](b)
            };
            var f;
            (f = d.Holder || k) && f.addEventListener(a, d.events[a])
        }
    }
    var d = this,
        i, h, j, g, c = e.config.positioning,
        l = e.config.properties.border || ["", 0, 0],
        m = a.mh.eventHandlers;
    d.events = {};
    d.__defineGetter__("dim", function () {
        var c = e.mode === "zoom",
            b = a.mb._imgSizes;
        return {
            thlWidth: c ? b[4] : a.gts("Width"),
            thlHeight: c ? b[5] : a.gts("Height"),
            wrpWidth: c ? b[4] + b[4] / 4 : a.gtws("Width"),
            wrpHeight: c ? b[5] : a.gtws("Height")
        }
    });
    d.__defineGetter__("ips", function () {
        return a.ips(e.pageNo)
    });
    d.onShowed = function () {};
    d.show = function (a) {
        if (d.isHiddenLink && d.ips) a.addEventListener("click", b);
        else {
            var c = function (c) {
                return c && a != c.parentNode ? (a.appendChild(c), !0) : !1
            };
            c(k);
            c(d.Holder) && c(d.Holder.dvLoad)
        } if (d.ips) d.onShowed()
    };
    d.remove = function (a) {
        if (d.isHiddenLink) a.removeEventListener("click", b);
        else {
            var c = function (c) {
                return c && a === c.parentNode ? (a.removeChild(c), !0) : !1
            };
            c(k);
            c(d.Holder) && c(d.Holder.dvLoad)
        }
    };
    d.positionate = function () {
        d.imgRate = d.dim.thlWidth / a.mb._imgSizes[2];
        var b = Math.round(d.imgRate * c[2]),
            e = Math.round(d.imgRate * c[3]);
        i = Math.round(d.imgRate * c[0]);
        h = Math.round(d.imgRate * c[1]);
        if (k) {
            var f = Math.round(l[2] * d.imgRate),
                m = Math.floor(f / 2);
            i -= m;
            h -= m;
            b -= f;
            e -= f;
            $dom.move(k, i, h);
            $dom.size(k, b, e);
            k.style.border = f + "px solid " + l[0];
            k.className = "Holder";
            $dom.transparent(k, l[1]);
            i += f;
            h += f
        }
        j = i + b;
        g = h + e;
        if (d.Holder) d.Holder.className = "Holder", $dom.move(d.Holder, i, h), $dom.size(d.Holder, b, e)
    };
    d.getSrc = a.mh.getSrc;
    if (e.type) d.Holder = document.createElement(e.type), d.Holder.instance = d;
    if (Number(l[1]) > 0) {
        var k = document.createElement("div");
        k.instance = d
    }(function () {
        for (var a = e.config.events || [], c = 0; c < a.length; c++)
            for (var b = a[c].actions, d = 0; d < b.length; d++) f(a[c].type.split("_")[1].toLowerCase().replace("ed", ""), b[d].actionType.tMN(), b[d])
    })();
    d.isHiddenLink = !d.Holder && !k && d.events.click;
    return d
}

function cActionController(a) {
    var e = this,
        b = [],
        f, d;
    e.handleEvent = function (a) {
        (e[b[a.type]] || $log.fatal)(a)
    };
    e.click = function (a) {
        f && (a.preventDefault(), a.stopPropagation())
    };
    e.touchStart = function () {
        d = !0;
        f = !1
    };
    e.touchMove = function () {
        return d ? f = !0 : !1
    };
    e.touchEnd = function () {
        return d ? (d = !1, f) : !1
    };
    (function (d) {
        for (var f = 0; f < d.length / 2; f++) b[d[f * 2]] = d[f * 2 + 1], a.addEventListener(d[f * 2], e, !0)
    })([$ua.isTouch() ? "touchstart" : "mousedown", "touchStart", $ua.isTouch() ? "touchmove" : "mousemove", "touchMove", $ua.isTouch() ? "touchend" : "mouseup", "touchEnd", "click", "click"]);
    return e
}

function cLayerScreen(a) {
    function e() {
        $dom.margin(i, 0, (a.gps("Height") - 45) / 2 - i.clientHeight / 2)
    }
    var b = this,
        f = _$("#LayerScreen"),
        d = _$("A", f),
        i = _$("#LayerContent", f),
        h = _$("#LayerTitle", f);
    b.content = i;
    b.canClose = !0;
    b.display = function (e) {
        if (b.canClose) d[(e ? "add" : "remove") + "EventListener"]("click", b.close);
        else $dom.hide(d);
        a.msp[e ? "goToScreen" : "goBack"](f, null, 1)
    };
    b.resize = function (a, b) {
        $dom.size(f, a, b);
        e()
    };
    b.setBackground = function (a) {
        f.style.backgroundColor = a;
        i.style.backgroundColor = a
    };
    b.show = function () {
        b.display(!0)
    };
    b.close = function () {
        b.display(!1)
    };
    b.appendHTML = function (a) {
        i.innerHTML = a;
        setTimeout(e, 300)
    };
    b.setTitle = function (a) {
        h.innerText = a || ""
    };
    return b
}

function cMP(a, e, b) {
    var f = new cLayerScreen(a),
        d = a.c,
        i = e.indexOf("YOUTUBE") >= 0,
        h = e == "IMAGE" ? "IMG" : !$ua.iP() && i && fd.vAL(10) ? "FLV" : i || e == "IFRAME" ? "YI" : "MP4",
        j = _$("#Player_" + h),
        g = new {
            FLV: function () {
                if (i) {
                    if (this.isCorrupted = !1, this.src = _$sbt(appConfig.socBookmarks.youtube.flv, [b, j.id]), !d.onYouTubePlayerReady) d.onYouTubePlayerReady = function () {
                        _$("#Player_FLV").addEventListener("onStateChange", "onytplayerStateChange");
                        _$("#Player_FLV").addEventListener("onError", "onytplayerError")
                    }, d.onytplayerStateChange = function (a) {
                        a == -1 && _$("#Player_FLV").playVideo()
                    }, d.onytplayerError = function () {
                        $log.error("YouTube FLV player load error (" + b + ")")
                    }
                } else this.src = b
            },
            YI: function () {
                this.src = _$sbt(appConfig.socBookmarks.youtube.emd, [b]);
                this.isCorrupted = !1;
                j.addEventListener("error", function () {
                    f.stop();
                    d.open(_$sbt(appConfig.socBookmarks.youtube.wth, [b]))
                })
            },
            MP4: function () {
                this.src = b
            },
            IMG: function () {
                this.src = b
            },
            IF: function () {
                this.src = b
            }
        }[e == "IFRAME" ? "IF" : h];
    f.display_i = f.display;
    f.display = function (a) {
        if (!$ua.iP() && i && top.eMagPromo && parseInt(top.device.version) > 3) return window.open(g.src, "_blank", "location=no");
        f.setBackground("#000");
        f.appendHTML("");
        f.display_i(a);
        h == "MP4" ? a ? (j.src = g.src, setTimeout(function () {
            $dom.show(j);
            setTimeout(function () {
                j.play()
            }, 200)
        }, 300)) : (j.pause(), j.src = "about:blank", $dom.hide(j)) : (h == "IMG" ? a ? $dom.p(j, g.src, null, function (a) {
            if (appConfig.basePath) window.mm.p(a.src, function (a) {
                j.origWidth = parseInt(a.width);
                j.origHeight = parseInt(a.height);
                f.onLoad()
            });
            else f.onLoad()
        }) : j.src = _$sbt(TITT, [appConfig.basePath]) : j.src = j.data = a ? g.src : _$sbt(TITT, [appConfig.basePath]), a ? setTimeout($dom.show, 300, j) : $dom.hide(j))
    };
    f.play = f.show;
    f.stop = f.close;
    f.resize_i = f.resize;
    f.resize = function (a, b) {
        f.resize_i(a, b);
        if (h == "IMG") {
            var d = Math.min((b - 35) / j.origHeight, a / j.origWidth);
            $dom.size(j, j.origWidth * d, j.origHeight * d);
            $dom.move(j, (a - j.origWidth * d) / 2, (b - 45 - j.origHeight * d) / 2 + 50);
            j.style.webkitBackgroundSize = j.style.width + " " + j.style.height
        } else $dom.size(j, a, b - 45)
    };
    return f
}

function cVideoPlayer(a, e, b, f) {
    var d = new cHB(a, {
        type: "div",
        config: e,
        pageNo: b,
        mode: f
    }),
        i = document.createElement("div"),
        h = document.createElement("div"),
        j = new cMP(a, e.properties.videoSrcType, d.getSrc(e.properties.videoSrcType, e.properties.videoSrc));
    h.id = "Play";
    i.id = "Thumb";
    d.Holder.appendChild(i);
    d.Holder.appendChild(h);
    d.Holder.addEventListener("click", function (a) {
        a.preventDefault();
        a.stopPropagation();
        j.play()
    });
    d.onShowed_i = d.onShowed;
    d.onShowed = function () {
        d.onShowed_i();
        i.style.webkitBackgroundSize = i.style.width + " " + i.style.height;
        e.properties.videoSrcType.indexOf("YOUTUBE") >= 0 ? $dom.p(i, _$sbt(appConfig.socBookmarks.youtube.thl, [e.properties.videoSrc])) : $dom.p(i, e.properties.videoThumbnail && "./../../" + e.properties.videoThumbnail.encodeFileName())
    };
    var g = d.positionate;
    d.positionate = function () {
        g();
        var c = e.positioning;
        $dom.size(i, Math.round(d.imgRate * c[2]), Math.round(d.imgRate * c[3]));
        $dom.move(h, f == "zoom" || Math.round(d.imgRate * c[2] / 2 - BUTTON_MEDIA_WIDTH * d.imgRate / 2), Math.round(d.imgRate * c[3] / 2 - BUTTON_MEDIA_HEIGHT * d.imgRate / 2));
        $dom.size(h, Math.round(BUTTON_MEDIA_WIDTH * d.imgRate), Math.round(BUTTON_MEDIA_HEIGHT * d.imgRate));
        j.resize(a.gps("Width"), a.gps("Height"))
    };
    return d
}

function cImageHolder(a, e, b, f) {
    var d = new cHB(a, {
        type: "div",
        config: e,
        pageNo: b,
        mode: f
    }),
        i = e.properties;
    d.Holder.style.position = "absolute";
    $dom.transparent(d.Holder, i.transparency);
    d.positionate_i = d.positionate;
    d.positionate = function () {
        d.positionate_i();
        d.Holder.style.webkitBackgroundSize = d.Holder.style.width + " " + d.Holder.style.height
    };
    d.onShowed_i = d.onShowed;
    d.onShowed = function () {
        d.onShowed_i();
        if (!d.Holder.led) {
            var a = i.imageSrcType.split(".")[1].toLowerCase();
            $dom.p(d.Holder, d.getSrc(a, i[a + "ImageSrc"]), void 0, function () {
                var a = document.createEvent("Event");
                a.initEvent("load", !1, !1);
                d.Holder.dispatchEvent(a);
                d.Holder.led = !0
            })
        }
    };
    return d
}

function cShape(a, e, b, f) {
    a = new cHB(a, {
        type: Number(e.properties.fill[1]) > 0 ? "div" : !1,
        config: e,
        pageNo: b,
        mode: f
    });
    if (a.Holder) a.Holder.style.backgroundColor = e.properties.fill[0], $dom.transparent(a.Holder, e.properties.fill[1]);
    return a
}

function cButton(a, e, b, f) {
    var d = new cHB(a, {
        type: "button",
        config: e,
        pageNo: b,
        mode: f
    });
    d.positionate_i = d.positionate;
    d.positionate = function () {
        d.positionate_i();
        if (d.Holder) $dom.aC(d.Holder, "ButtonHolder"), d.Holder.innerText = e.properties.label || "", d.Holder.style.font = Math.round(d.imgRate * e.properties.fontSize) + "px " + e.properties.fontFamily, d.Holder.style.color = e.properties.color
    };
    return d
}

function cSlideShow(a, e, b, f) {
    function d(a) {
        function b(a, d, e) {
            e || $dom.move(a, f == "zoom" || Math.round(i - d[0] * c.imgRate / 2), Math.round(k - d[1] * c.imgRate / 2));
            $dom.size(a, Math.round(d[0] * c.imgRate), Math.round(d[1] * c.imgRate))
        }
        if (a.origWidth) {
            var d = parseInt(c.Holder.style.width),
                e = d,
                g = parseInt(c.Holder.style.height),
                h = g;
            a.origWidth / a.origHeight > e / h ? (h = Math.round(a.origHeight / a.origWidth * e), a.style.marginTop = Math.round((g - h) / 2) + "px", a.style.marginLeft = "") : (e = Math.round(a.origWidth / a.origHeight * h), a.style.marginLeft = Math.round((d - e) / 2) + "px", a.style.marginTop = "");
            $dom.size(a, e, h);
            a.style.backgroundSize = e + "px " + h + "px";
            var i = (parseInt(a.style.marginLeft) || 0) + e / 2,
                k = (parseInt(a.style.marginTop) || 0) + h / 2;
            b(q, [BUTTON_MEDIA_WIDTH, BUTTON_MEDIA_HEIGHT]);
            b(n, [BUTTON_MEDIA_WIDTH, BUTTON_MEDIA_HEIGHT]);
            o && b(v, [BUTTON_WAY_WIDTH, BUTTON_MEDIA_HEIGHT], !0)
        }
    }

    function i() {
        o && c.prop.descriptions != "HIDE" && c.setDescription(k[(c.itemIndex > 0 ? c.itemIndex : k.length) - 1].description)
    }

    function h(a) {
        clearTimeout(r);
        r = setTimeout(function () {
            if (c.itemIndex >= k.length) c.itemIndex = 0;
            g();
            v && $dom.hide(v)
        }, a || c.prop.time * 1E3)
    }

    function j(a) {
        p = !1;
        c.itemIndex >= k.length ? c.prop.repeat || a ? h() : (c.isPaused && $dom.hide(q), $dom.show(n)) : !c.prop.autoPlay && !o ? $dom.show(q) : h()
    }

    function g() {
        c.ips ? !c.isPaused && !p && k.length && (p = !0, u = !1, s ? c.p(function () {
            i();
            j(!0)
        }) : $dom.p(m, c.getSrc(z, k[c.itemIndex++].src), _$sbt(TITT, [appConfig.basePath]), function (a) {
            d(a);
            $dom.transitionEndHandle(l, function (c) {
                $dom.size(c, parseInt(a.style.width), parseInt(a.style.height));
                c.origWidth = parseInt(a.style.width);
                c.origHeight = parseInt(a.style.height);
                $dom.margin(c, parseInt(a.style.marginLeft) || 0, parseInt(a.style.marginTop) || 0);
                c.style.backgroundImage = a.style.backgroundImage;
                c.style.backgroundSize = a.style.backgroundSize;
                $dom.transitionEndHandle(c, function () {
                    $dom.transparent(a, 0);
                    j()
                });
                $dom.transparent(c, 1);
                i()
            });
            $dom.transparent(l, 0);
            $dom.transparent(a, 1)
        }), s = !1) : c.stop()
    }
    var c = new cHB(a, {
        type: "div",
        config: e,
        pageNo: b,
        mode: f
    }),
        l = c.Holder.appendChild(document.createElement("DIV")),
        m = c.Holder.appendChild(document.createElement("DIV")),
        k, n = document.createElement("div"),
        q = document.createElement("div"),
        p, o = e.type,
        r, u = !1,
        s = !1;
    $dom.transparent(l, 1);
    $dom.transparent(m, 0);
    c.mode = f;
    q.id = "Play";
    c.Holder.appendChild(q);
    n.id = "Replay";
    c.Holder.appendChild(n);
    c.itemIndex = e.properties.itemIndex;
    c.prop = e.properties;
    var z = c.prop.srcType.toLowerCase();
    if (o) {
        var v = document.createElement("div"),
            t = new cActionController(c.Holder),
            y, x;
        l.appendChild(v);
        var w = function () {
            v.className = "Button" + (u ? "Prev" : "Next");
            $dom.show(v)
        };
        t.touchStart_i = t.touchStart;
        t.touchStart = function (a) {
            t.touchStart_i(a);
            y = a.x || a.x != 0 && a.changedTouches[0].pageX
        };
        t.touchMove_i = t.touchMove;
        t.touchMove = function (a) {
            x = a.x || a.x != 0 && a.changedTouches[0].pageX;
            u = y < x;
            t.touchMove_i(a) && !p && !c.isReplayShowed && !c.isPaused && w(a)
        };
        t.touchEnd_i = t.touchEnd;
        t.touchEnd = function (a) {
            x = a.x || a.x != 0 && a.changedTouches[0].pageX;
            u = y < x;
            if (t.touchEnd_i(a) && !p && !c.isReplayShowed && !c.isPaused) {
                w(a);
                if (u) c.itemIndex = c.itemIndex - 2 < 0 ? k.length - 1 : c.itemIndex - 2;
                else if (c.index >= k.length) c.itemIndex = 0;
                s = !0;
                h(100)
            }
        }
    }
    c.__defineGetter__("isPaused", function () {
        return q.style.display != "none"
    });
    c.__defineGetter__("isReplayShowed", function () {
        return window.getComputedStyle(n).display != "none"
    });
    c.play = function (a) {
        a > -1 && (c.itemIndex = a);
        $dom.hide(q);
        h()
    };
    c.pause = function () {
        $dom.show(q);
        if (c.prop.autoPlay && !o) q.style.visibility = "hidden"
    };
    c.stop = function () {
        $dom.transparent(l, 1);
        $dom.transparent(m);
        c.itemIndex = 0;
        k && c.p(function () {
            i();
            $dom.hide(n);
            c.pause();
            p = !1
        })
    };
    c.Holder.addEventListener("click", function (b) {
        v && $dom.hide(v);
        b.preventDefault();
        b.stopPropagation();
        if (o)
            if (c.isReplayShowed) c.stop(), c.play();
            else if (c.isPaused) c.play();
        else {
            var b = b.x || b.x != 0 && b.changedTouches[0].pageX,
                d = c.Holder.offsetWidth / 2 - l.offsetWidth * 0.3,
                f = c.Holder.offsetWidth / 2 + l.offsetWidth * 0.3;
            if (b < d || b > f) {
                if (s = !0, !p) b < d ? (c.itemIndex = c.itemIndex - 2 < 0 ? k.length - 1 : c.itemIndex - 2, h(100), u = !0, w()) : (w(), h(100))
            } else $dom.show(q)
        } else a.mh.eventHandlers.openSlideshowInWindow(e.properties, c), c.isReplayShowed ? c.stop() : c.pause()
    });
    c.setDescription = function () {};
    c.positionate_i = c.positionate;
    c.positionate = function () {
        if (o) {
            c.imgRate = c.dim.thlWidth / a.mb._imgSizes[2];
            var b = c.position = [0, TTBH, a.gps("Width"), a.gps("Height") - TTBH];
            if (c.Holder) c.Holder.className = "Holder", $dom.move(c.Holder, b[0], b[1]), $dom.size(c.Holder, b[2], b[3])
        } else c.positionate_i();
        $dom.aC(c.Holder, "SlideShow");
        d(l);
        d(m)
    };
    c.p = function (e) {
        if (k.length) {
            if (f == "zoom") c.itemIndex = a.mh.getHolderPropertyValue("page", b, c.i, "itemIndex") - 1;
            $dom.p(l, c.getSrc(z, k[c.itemIndex++].src), null, function (a) {
                d(a);
                e()
            })
        }
    };
    c.onShowed_i = c.onShowed;
    c.onShowed = function () {
        c.onShowed_i();
        k = c.prop.slideShowItems;
        if (k.length) {
            if (!c.itemIndex || c.itemIndex < 0 || c.index >= k.length) c.itemIndex = 0;
            l.style.backgroundImage ? c.prop.autoPlay && c.isPaused && c.play() : c.p(function () {
                c.prop.autoPlay ? c.play() : c.pause()
            });
            i()
        }
    };
    c.remove_i = c.remove;
    c.remove = function (a) {
        c.stop();
        c.remove_i(a)
    };
    return c
}
var eMagReader = new function (a) {
        var e, b, f;

        function d() {
            function a(b, c) {
                for (var d = 0; d < b.length; d++)
                    for (var e = 0; e < c.length; e++)
                        if (c[e].id.indexOf(b[d]) >= 0 && (c[e].showed = !0, $dom.rc(c[e], "imm", "showDefault"), e != d)) {
                            $dom.sN(c[e], c[d]);
                            var f = c[e];
                            c[e] = c[d];
                            c[d] = f
                        }
                for (d = 0; d < c.length; d++) c[d].showed || $dom.hide(c[d])
            }
            var b = c.mb.settings;
            if (!b || !b.controlBarButtons || !b.menuButtons) b = {
                controlBarButtons: ["Text", "Menu", "Zoom"],
                menuButtons: ["Index", "Search", "Share", "Bookmarks", "GoTo"]
            };
            if (b.controlBarButtons)
                for (var d = _$(".cp", null, !1, !0), e = 0; e < d.length; e++) a(b.controlBarButtons, $dom.cTA(_$(".imm", d[e], !1, !0)));
            b.menuButtons && a(b.menuButtons, $dom.cTA(_$("#cpm>LI", null, !1, !0)))
        }

        function i() {
            function a(c) {
                for (var b = document.getElementsByTagName("link"), d = 0; d < b.lenght; d++)
                    if (b[d].rel == c) return !1;
                return !0
            }
            $dom.aC(document.body, "iOS");
            var c = _$("head"),
                b, d = {
                    "apple-mobile-web-app-capable": "yes",
                    "apple-mobile-web-app-status-bar-style": "black",
                    "apple-touch-fullscreen": "yes"
                }, e = {
                    "apple-touch-icon": "apple-touch-icon.png",
                    "apple-touch-startup-image": "apple-touch-startup.png"
                }, f;
            for (f in d)
                if (document.getElementsByName(f).lenght <= 0) b = document.createElement("meta"), b.name = f, b.content = d[f], c.appendChild(b);
            for (f in e)
                if (a(f)) b = document.createElement("link"), b.rel = f, b.href = e[f], c.appendChild(b)
        }

        function h(a) {
            var b = _$get(appConfig.basePath + "tmpl/default/body.htm"),
                d;
            for (d in c.labels) b = b.rT(c.labels[d]);
            a.innerHTML = b.rT(c.mb.internalTags);
            return a
        }

        function j(a, b) {
            if (b) c[a] ? $log.warn('"eMagReader.' + a + '" manager is already defined.') : c[a] = new b(c);
            else return $log.error('"' + /(\w+)\(/.exec(b.toString())[1] + '" class is undefined.'), !1;
            c[a].l()
        }

        function g() {
            $dom.margin(l.msg, c.gps("Width") / 2 - 100, c.gps("Height") / 2 - l.msg.clientHeight / 2)
        }
        var c = this,
            l, m;
        c.useStorage = !0;
        c.c = a;
        c[SP] = function () {
            e = void 0;
            b = void 0;
            f = void 0;
            a.cache = {};
            c.d = !0;
            $ua.iP() && i();
            var d = _$("#splashScreen"),
                g = d.childNodes[0];
            $dom.size(d, c.gps("Width"), c.gps("Height") + 100);
            $dom.move(g, c.gps("Width") / 2 - g.clientWidth / 2, c.gps("Height") / 2 - g.clientHeight / 2);
            j("mb", cbm)
        };
        c.old = function () {
            l = $dom.i(h(_$("#content", document, !0)), c, {
                reader: c.pagerID,
                ctr: "#container",
                splash: "#splashScreen",
                msg: "#splashWnd",
                prompt: "#prompt"
            });
            if (!top.eMagReader && !$ua.allowed()) c.sa("lblBrowserError", !1, !1);
            else {
                j("ms", csm);
                j("msp", csp);
                j("msr", csrs);
                j("msc", css);
                j("mtr", ctr);
                j("mi", cis);
                j("mz", czm);
                j("mngSecurity", cSecurityManager);
                j("mh", cHM);
                j("mngPageFlipper", cPageFlipper);
                j("mo", co);
                j("mbmark", cBookmarkScreen);
                try {
                    d(), m = c.mngPageFlipper.i(), c.d = !1, l.splash.innerHTML = "", c.dl(c.irc && c.mb.gup() < 0)
                } catch (a) {
                    c.d = !0, $log.error("i page reader error: " + a.message), c.sa("Initialization error. Please reload application.")
                }
            }
        };
        c.unLoadData = function () {
            c.d = !0;
            delete m;
            m = void 0;
            a.location.hash = "";
            document.body.className = ""
        };
        c.scroll = function (b) {
            b ? setTimeout(a.scrollTo, 0, 0, 1) : a.scrollTo(0, 1)
        };
        c.dp = function (a) {
            function b(a, d) {
                $dom.uC(_$("#cp" + (c.mo.isLandscape ? "v" : "h") + "Pg" + a), "cDisabled", d)
            }
            c.mtr.i();
            m.dp(a);
            c.mz.isShowed && c.mz.i();
            b("Prev", c.mb.fi);
            b("Next", c.mb.il)
        };
        c.gts = function (a) {
            if (!e) {
                e = {
                    0: {
                        Height: 1 / c.mb.imgRatio,
                        Width: 0
                    },
                    1: {
                        Width: c.mb.imgRatio,
                        Height: 0
                    }
                }[Number(c.gtws("Width") / c.gtws("Height") > c.mb.imgRatio)];
                for (var b in e)
                    if (d) e[b] = c.gtws(b) - e[b], e[d] = Math.round(e[d] * e[b]);
                    else var d = b
            }
            return e[a]
        };
        c.gtws = function (a) {
            if (!b) {
                b = {
                    Width: c.mb.pageStep,
                    Height: 1
                };
                for (var d in b) b[d] = Math.ceil(c.grs(d) / b[d])
            }
            return b[a]
        };
        c.grs = function (a) {
            if (!f) {
                var b = c.mb.settings.hideControlbar ? 0 : CPW,
                    d = c.mb.settings.showPageNumbers ? 15 : 0;
                f = {
                    0: {
                        Width: b,
                        Height: d
                    },
                    1: {
                        Height: b + d,
                        Width: 0
                    }
                }[Number(!c.mo.isLandscape)];
                for (var e in f) f[e] = c.gps(e) - f[e]
            }
            return f[a]
        };
        c.gps = function (b) {
            return c[b] || a["inner" + b]
        };
        c.i = function () {
            if (m) {
                e = void 0;
                b = void 0;
                f = void 0;
                $dom.size(l.splash, c.gps("Width"), c.gps("Height"));
                g();
                for (var a = _$(".s100", null, !1, !0), d = 0; d < a.length; d++) $dom.size(a[d], c.gps("Width"), c.gps("Height"));
                c.mh.i();
                m.iThumbnails();
                c.ms.i();
                c.mtr.dl();
                c.mi.dl();
                c.dp(!0);
                c.mngSecurity.i()
            }
        };
        c.dl = function (a) {
            if (c.d) return c.i();
            c.sa(a ? "lblInstructionLabel" : "lblLoading", a, a);
            c.ira ? ($dom.transitionEndHandle(l.ctr, function (a) {
                c.i();
                $dom.transitionEndHandle(a, c.ha);
                $dom.transparent(a, 1)
            }), $dom.transparent(l.ctr, 0)) : (c.i(), c.ha())
        };
        c.sp = function (a, b, c) {
            function d(a) {
                a = a ? "hide" : "show";
                $dom[a](l.prompt);
                $dom[a](l.splash)
            }
            _$(".message", l.prompt).innerHTML = a;
            var e = _$(".inputWrap INPUT", l.prompt);
            e.placeholder = b;
            e.addEventListener("keydown", function (a) {
                a.keyCode == 13 && c(e.value) && d(!0)
            });
            _$("#ok", l.prompt).addEventListener("click", function () {
                c(e.value) && d(!0)
            });
            _$("#Cancel", l.prompt).addEventListener("click", d);
            d();
            e.focus()
        };
        c.sa = function (a, b, d, e) {
            if (l.msg.locked) return !1;
            c.scroll();
            l.msg.locked = e;
            l.msg.innerHTML = c.loc(a).replace(/(\n)/gm, "<br>");
            d && $dom.show(l.splash);
            $dom.show(l.msg);
            g();
            l.msg.closeOnClick = b;
            if (!l.msg._inited) a = function () {
                if (l.msg.closeOnClick) l.msg.closeOnClick = !1, c.ha()
            }, l.splash.addEventListener("click", a), l.msg.addEventListener("click", a), l.msg._inited = !0;
            return !0
        };
        c.ha = function () {
            !l.msg.closeOnClick && !l.msg.locked && ($dom.hide(l.splash), $dom.hide(l.msg))
        };
        c.loc = function (a, b, d) {
            a = c.labels[d || "other"][a] || c.labels.general[a] || a;
            return b ? _$sbt(a, b) : a
        };
        c.handleEvent = function (a) {
            try {
                c[a.type](a)
            } catch (b) {
                $log.error(b.stack || b)
            }
        };
        c.__defineGetter__("d", function () {
            return c._d_
        });
        c.__defineSetter__("d", function (a) {
            c._d_ = a;
            if (m) m.d = a
        });
        c.__defineGetter__("isTest", function () {
            return !R && !a.STARTUP_METHOD
        });
        c.__defineGetter__("irc", function () {
            return !c.isTest && !a.STARTUP_METHOD
        });
        c.__defineGetter__("ira", function () {
            return l.msg.style.display != "block" && l.prompt.style.display != "block" && c.msp.hist.length <= 1
        });
        c.ips = function (a) {
            var b = c.mb.cp;
            return a == b || c.mo.lp && a + (a % 2 ? -1 : 1) == b
        };
        c.__defineGetter__("pagerType", function () {
            return {
                flipping: PT_2DWEB_KIT,
                sliding: PT_SCROLL
            }[c.mb.settings.viewMode || "sliding"]
        });
        c.__defineGetter__("pagerID", function () {
            return "#" + ["", "f", "c", "t"][c.pagerType] + "rdr"
        });
        (function (b) {
            for (var d = 0; d < b.length; d++) c[b[d]] && a.addEventListener(b[d], c)
        })(["DOMContentLoaded", "scroll"]);
        a.ss = [c, j, SP, 261, !0, void 0]
    }(window);