function c3DPages(i,f,l){function m(){return[{x:0,y:e,z:0},{x:g,y:e,z:0},{x:g,y:-e,z:0},{x:0,y:-e,z:0}]}function n(a){var b=new top.c3D.Object;b.perslevel=g*6;b.ophi=a;b.scale=1;b.textures=[j,j];b.__defineGetter__("initial",function(){return{points:m(),faces:[{vertices:[0,1,2,3],texture:0},{vertices:[1,0,3,2],texture:1}]}});b.holders=[];b.last=!1;b.order=b._index=a;b.__defineGetter__("prev",function(){var a=this._index-1;return c[a<0?f:a]});b.__defineGetter__("next",function(){var a=this._index+1;
return c[a>=f?0:a]});b.__defineSetter__("order",function(a){this.__order=a;this.transform((a<0?-180:0)+a)});b.__defineGetter__("order",function(){return this.__order});b.__defineGetter__("side",function(){return Number(this.ophi>-90)});b.__defineGetter__("detained",function(){return this.ophi<=-180+this.order||this.ophi>=this.order});b.__defineGetter__("boundDeg",function(){return(this.side?0:-180)+this.order});b.transform=function(a){this.ophi=this.detained&&(this.side?a>this.ophi:a<this.ophi)?this.boundDeg:
a};b.build=function(){for(var a=this.initial,b,c,d=0;d<this.holders.length;d++){c=a.points.length;a.points=a.points.concat(this.holders[d].points);b=this.holders[d].faces;for(var f=0;f<b.length;f++)for(var e=0;e<b[f].vertices.length;e++)b[f].vertices[e]+=c;a.faces=a.faces.concat(b)}return this.init(a.points,a.faces)};return b.build()}var c=Array(f),j=new Image,g=l.width,e=Math.round(l.height/2);j.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";c.__defineSetter__("size",function(a){g=
a.width;e=Math.round(a.height/2);for(var b=0;b<c.length;b++)c[b].points=m(),c[b].perslevel=g*6,c[b].m=a.m,c[b].l=a.l});c.__defineGetter__("top",function(){for(var a={left:null,right:null},b=0;b<f;b++){var e=c[b].side,h,g=e?"right":"left";if(!(h=a[g])||(e?h.order>c[b].order:h.order<c[b].order))a[g]=c[b]}return a});(function(){for(var a=0;a<f;a++)c[a]=n(a)})();return c}
function c3DFlipper(i,f,l){function m(){if(t!=a.pagesTop.right)a.onPageChanged(p);h=!0}function n(){h||(a.ctr.frame(),setTimeout(n,0))}function c(){if(!d||d.detained)if(!(d=a.pagesTop[o>q?"left":"right"])||d.last)return;var b=(p?-1:1)*6;r?(d.transform(d.ophi+b),a.ctr.frame()):(d.fall("phi",p?-180:0,b,m),n(h=!1))}function j(b){b.preventDefault();b.stopPropagation();if(h)t=a.pagesTop.right,q=(k?b.changedTouches[0]:b).pageX}function g(a){if(q)o=(k?a.changedTouches[0]:a).pageX,r=!0,c(),p=u>o,u=o}function e(a){a.preventDefault();
a.stopPropagation();r?(r=!1,c()):window.$dom.dispatchClick(a);q=0}var a=this,b=[],s=new c3DPages(a,f,l),h=!0,o,d,t,u,q,p,r,k=top.$ua.isTouch();a.disabled=!1;a.landscape=!0;a.__defineSetter__("pageSize",function(b){b.l=a.landscape?Math.round(i.width/2):(i.width-b.width)/2;b.m=Math.round(i.height/2);s.size=b});a.__defineGetter__("pagesTop",function(){return s.top});a.onPageChanged=function(){};a.handleEvent=function(c){if(a.disabled)return!0;b[c.type](c);return!1};(function(){a.ctr=new top.c3D.Controller(i,
!1);for(var c=0;c<f;c++)a.ctr.addObject(s[c]);a.ctr.frame();for(var c=[k?"touchstart":"mousedown",j,k?"touchmove":"mousemove",g,k?"touchend":"mouseup",e],d=0;d<c.length/2;d++)b[c[d*2]]=c[d*2+1],i.addEventListener(c[d*2],a)})();return a};